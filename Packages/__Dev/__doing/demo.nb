(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     85192,       2383]
NotebookOptionsPosition[     78525,       2261]
NotebookOutlinePosition[     78953,       2278]
CellTagsIndexPosition[     78910,       2275]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["game24play", "Section",
 CellChangeTimes->{
  3.7227697180011415`*^9},ExpressionUUID->"4be31f26-bcb2-4dea-ad26-\
3cf462e3832a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"treeR", "[", "n_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"o", "[", 
     RowBox[{
      RowBox[{"treeR", "[", "a", "]"}], ",", 
      RowBox[{"treeR", "[", 
       RowBox[{"n", "-", "a"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "1", ",", 
      RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"treeR", "[", "1", "]"}], ":=", "n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"tree", "[", "n_", "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"treeR", "[", "n", "]"}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"o", "[", 
         RowBox[{"a_List", ",", "b_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"o", "[", 
            RowBox[{"#", ",", "b"}], "]"}], "&"}], "/@", "a"}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"o", "[", 
         RowBox[{"a_", ",", "b_List"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"o", "[", 
            RowBox[{"a", ",", "#"}], "]"}], "&"}], "/@", "b"}], ")"}]}]}], 
      "}"}]}], "]"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"game24play", "[", "val_List", "]"}], ":=", 
  RowBox[{"Union", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"StringReplace", "[", 
      RowBox[{
       RowBox[{"StringTake", "[", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"#", ",", "InputForm"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"10", ",", 
           RowBox[{"-", "2"}]}], "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"\"\<-1*\>\"", "~~", "n_"}], "\[RuleDelayed]", 
        RowBox[{"\"\<-\>\"", "<>", "n"}]}]}], "]"}], "&"}], "/@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"HoldForm", "/@", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Union", "@", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Outer", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"o", "[", "q_Integer", "]"}], "\[RuleDelayed]", 
                  RowBox[{"#2", "[", 
                   RowBox[{"[", "q", "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"n", "[", "q_", "]"}], "\[RuleDelayed]", 
                  RowBox[{"#3", "[", 
                   RowBox[{"[", "q", "]"}], "]"}]}]}], "}"}]}], "&"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Block", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"O", "=", "1"}], ",", 
                   RowBox[{"N", "=", "1"}]}], "}"}], ",", 
                 RowBox[{"#", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"o", "\[RuleDelayed]", 
                    RowBox[{"o", "[", 
                    RowBox[{"O", "++"}], "]"}]}], ",", 
                    RowBox[{"n", "\[RuleDelayed]", 
                    RowBox[{"n", "[", 
                    RowBox[{"N", "++"}], "]"}]}]}], "}"}]}]}], "]"}], "&"}], "/@", 
              RowBox[{"tree", "[", "4", "]"}]}], ",", 
             RowBox[{"Tuples", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "Plus", ",", "Subtract", ",", "Times", ",", "Divide"}], "}"}],
                ",", "3"}], "]"}], ",", 
             RowBox[{"Permutations", "[", 
              RowBox[{"Array", "[", 
               RowBox[{"v", ",", "4"}], "]"}], "]"}], ",", "1"}], "]"}], 
           "]"}]}], ",", 
         RowBox[{
          RowBox[{"Quiet", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "/.", 
              RowBox[{
               RowBox[{"v", "[", "q_", "]"}], "\[RuleDelayed]", 
               RowBox[{"val", "[", 
                RowBox[{"[", "q", "]"}], "]"}]}]}], ")"}], "\[Equal]", "24"}],
            "]"}], "&"}]}], "]"}]}], "/.", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"v", "[", "q", "]"}], "\[Rule]", 
         RowBox[{"val", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"q", ",", "4"}], "}"}]}], "]"}]}], ")"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.7226506470490503`*^9, 3.722650647916032*^9}, {
  3.7227571930037727`*^9, 
  3.7227572119382477`*^9}},ExpressionUUID->"635d6187-735e-4616-a324-\
13e291f0ae25"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"game24play", "[", 
    RowBox[{"{", 
     RowBox[{"3", ",", "7", ",", "6", ",", "1"}], "}"}], "]"}], "//", "TT"}], 
  "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.722650656327359*^9, 3.722650656375836*^9}, 
   3.7227506885699015`*^9, {3.722757306704685*^9, 
   3.7227573103472414`*^9}},ExpressionUUID->"7a4c0846-eaca-4287-8908-\
a3b102a4386f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox["\<\"\:603b\:8fd0\:884c\:65f6: \"\>",
   "EchoLabel"], " ", "0.16136081385334702`"}]], "Echo",
 CellChangeTimes->{
  3.722757311155553*^9},ExpressionUUID->"bf3bc895-ed80-42e7-a6b6-\
eed2e8fee2d5"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"CPU \:65f6\:95f4: \"\>",
   "EchoLabel"], " ", "0.171875`"}]], "Echo",
 CellChangeTimes->{
  3.722757311177215*^9},ExpressionUUID->"2b280299-044a-45fd-9736-\
0679d40d5374"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {"\<\"(-3 + 6)*(7 + 1)\"\>"},
     {"\<\"((-3 + 7)*6)/1\"\>"},
     {"\<\"(-3 + 7)*6*1\"\>"},
     {"\<\"6 - 3*(-7 + 1)\"\>"},
     {"\<\"6*(-3 + 7*1)\"\>"},
     {"\<\"6*(-3 + 7/1)\"\>"},
     {"\<\"6 + 3*(7 - 1)\"\>"},
     {"\<\"6*(7 - 3*1)\"\>"},
     {"\<\"6*(7 - 3/1)\"\>"},
     {"\<\"7 + 3*6 - 1\"\>"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7226506568704247`*^9, 3.722650665858526*^9}, {
   3.722750689616638*^9, 3.7227506934841337`*^9}, 3.7227570973503256`*^9, 
   3.722757246186157*^9, 
   3.7227573111983213`*^9},ExpressionUUID->"2e1736c8-1a51-45fb-96f0-\
f1a4cfaeeca9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"tree", "[", "4", "]"}], "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.72275716708805*^9, 3.7227571683887005`*^9}, {
  3.7227572011668825`*^9, 
  3.7227572323308887`*^9}},ExpressionUUID->"b434bd63-a539-4b92-bb71-\
110ae09d7a50"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{"o", "[", 
       RowBox[{"n", ",", 
        RowBox[{"o", "[", 
         RowBox[{"n", ",", 
          RowBox[{"o", "[", 
           RowBox[{"n", ",", "n"}], "]"}]}], "]"}]}], "]"}]},
     {
      RowBox[{"o", "[", 
       RowBox[{"n", ",", 
        RowBox[{"o", "[", 
         RowBox[{
          RowBox[{"o", "[", 
           RowBox[{"n", ",", "n"}], "]"}], ",", "n"}], "]"}]}], "]"}]},
     {
      RowBox[{"o", "[", 
       RowBox[{
        RowBox[{"o", "[", 
         RowBox[{"n", ",", "n"}], "]"}], ",", 
        RowBox[{"o", "[", 
         RowBox[{"n", ",", "n"}], "]"}]}], "]"}]},
     {
      RowBox[{"o", "[", 
       RowBox[{
        RowBox[{"o", "[", 
         RowBox[{"n", ",", 
          RowBox[{"o", "[", 
           RowBox[{"n", ",", "n"}], "]"}]}], "]"}], ",", "n"}], "]"}]},
     {
      RowBox[{"o", "[", 
       RowBox[{
        RowBox[{"o", "[", 
         RowBox[{
          RowBox[{"o", "[", 
           RowBox[{"n", ",", "n"}], "]"}], ",", "n"}], "]"}], ",", "n"}], 
       "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7227571687072415`*^9, {3.7227571994100375`*^9, 
   3.722757232737215*^9}},ExpressionUUID->"c7029ffc-5579-461c-9d8c-\
bb9e583acb2e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Hyperlink", "[", 
  RowBox[{
  "Poker24", ",", 
   "\"\<https://rosettacode.org/wiki/24_game/Solve#Mathematica_.2F_Wolfram_\
Language\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.722650677686729*^9, 
  3.72265070205757*^9}},ExpressionUUID->"cfdec555-031a-4b1c-9973-\
8478f59864b7"],

Cell[BoxData[
 TemplateBox[{
  "Poker24",
   "https://rosettacode.org/wiki/24_game/Solve#Mathematica_.2F_Wolfram_\
Language"},
  "HyperlinkURL"]], "Output",
 CellChangeTimes->{{3.722650678925707*^9, 
  3.72265070242763*^9}},ExpressionUUID->"90b6e39a-0a1d-4b63-84fc-\
5d164fd87766"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["game24", "Section",
 CellChangeTimes->{
  3.7227697246149607`*^9},ExpressionUUID->"c067f0f7-d57d-4348-9cbe-\
7da1a813ddf7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"game24", "[", 
   RowBox[{"input_List", ",", 
    RowBox[{"result_:", " ", "24"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"add", ",", "sub", ",", "mul", ",", "div"}], "}"}], ",", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"oprules", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"add", "\[Rule]", "Plus"}], ",", 
           RowBox[{"sub", "\[Rule]", "Subtract"}], ",", 
           RowBox[{"mul", "\[Rule]", "Times"}], ",", 
           RowBox[{"div", "\[Rule]", "Divide"}]}], "}"}]}], ",", 
        RowBox[{"specifics", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"div", "[", 
             RowBox[{"x_", ",", "1"}], "]"}], "\[RuleDelayed]", "x"}], ",", 
           RowBox[{
            RowBox[{"mul", "[", 
             RowBox[{"x_", ",", "1"}], "]"}], "\[RuleDelayed]", "x"}], ",", 
           RowBox[{
            RowBox[{"mul", "[", 
             RowBox[{"1", ",", "x_"}], "]"}], "\[RuleDelayed]", "x"}], ",", 
           RowBox[{
            RowBox[{"add", "[", 
             RowBox[{"2", ",", "2"}], "]"}], "\[Rule]", 
            RowBox[{"mul", "[", 
             RowBox[{"2", ",", "2"}], "]"}]}]}], "}"}]}]}], "}"}], ",", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{"RightComposition", "[", 
         RowBox[{"Hold", ",", 
          RowBox[{"ReplaceAll", "[", "oprules", "]"}], ",", 
          RowBox[{
           RowBox[{"ToString", "[", 
            RowBox[{"#", ",", "InputForm"}], "]"}], "&"}], ",", 
          RowBox[{"StringDelete", "[", 
           RowBox[{"{", 
            RowBox[{"\"\<Hold[\>\"", ",", "\"\<]\>\""}], "}"}], "]"}], ",", 
          RowBox[{"StringReplace", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<*\>\"", "\[Rule]", "\"\<\[Times]\>\""}], ",", 
             RowBox[{"\"\</\>\"", "\[Rule]", "\"\<\[Divide]\>\""}]}], "}"}], 
           "]"}]}], "]"}], ",", 
        RowBox[{"Union", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"result", "\[Equal]", 
              RowBox[{"(", 
               RowBox[{"#", "/.", "oprules"}], ")"}]}], "&"}], "]"}], "@", 
           RowBox[{"Groupings", "[", 
            RowBox[{
             RowBox[{"Permutations", "@", "input"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"add", ",", "sub", ",", "mul", ",", "div"}], "}"}], 
              "\[Rule]", "2"}]}], "]"}]}], ",", 
          RowBox[{"SameTest", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"0", "===", 
              RowBox[{"Simplify", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"sub", "[", 
                  RowBox[{"#1", ",", "#2"}], "]"}], "//.", "specifics"}], "/.", 
                RowBox[{"Prepend", "[", 
                 RowBox[{"oprules", ",", 
                  RowBox[{"k_Integer", "\[RuleDelayed]", 
                   RowBox[{"ToString", "[", "k", "]"}]}]}], "]"}]}], "]"}]}], 
             "&"}], ")"}]}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.722750629896695*^9, 
  3.7227506384618597`*^9}},ExpressionUUID->"9f99713d-ead6-4aba-896f-\
17708a3f3037"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Quiet", "@", 
    RowBox[{"game24", "[", 
     RowBox[{"{", 
      RowBox[{"3", ",", "7", ",", "6", ",", "1"}], "}"}], "]"}]}], "//", 
   "TT"}], "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.722750642022914*^9, 3.7227506644127803`*^9}, 
   3.7227573234585466`*^9},ExpressionUUID->"981fdc67-308b-4f39-955f-\
2d9a0444331e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox["\<\"\:603b\:8fd0\:884c\:65f6: \"\>",
   "EchoLabel"], " ", "0.2548941395355781`"}]], "Echo",
 CellChangeTimes->{
  3.7227573243535213`*^9},ExpressionUUID->"b60c0d47-7032-4045-bdf0-\
345dd07da856"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"CPU \:65f6\:95f4: \"\>",
   "EchoLabel"], " ", "0.234375`"}]], "Echo",
 CellChangeTimes->{
  3.7227573243725348`*^9},ExpressionUUID->"375ecccb-cf19-4ae0-b3ed-\
c0f86736ef29"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {"\<\"6 + 3\[Times](7 - 1)\"\>"},
     {"\<\"7 + (3\[Times]6 - 1)\"\>"},
     {"\<\"6\[Divide](1\[Divide](7 - 3))\"\>"},
     {"\<\"(6\[Times](7 - 3))\[Divide]1\"\>"},
     {"\<\"(1 + 7)\[Times](6 - 3)\"\>"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.722750644619388*^9, 3.722750664938198*^9}, 
   3.7227573243940496`*^9},ExpressionUUID->"0869d554-33ed-4a5d-89cc-\
819348926a22"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["game24", "Section",
 CellChangeTimes->{
  3.7227697246149607`*^9},ExpressionUUID->"76190c84-0ca0-43ba-b8e3-\
18f0c1ee1e16"],

Cell[BoxData[
 RowBox[{
  RowBox[{"point24", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a_", ",", " ", "b_", ",", " ", "c_", ",", " ", "d_"}], "}"}], 
    ",", " ", 
    RowBox[{"goal_:", "24"}]}], "]"}], " ", ":=", " ", "\n", "     ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"h", ",", " ", "temp", ",", " ", "actionF", ",", " ", "printF"}],
      "}"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"m_", ",", " ", "m_", ",", " ", "num_"}], "]"}], " ", ":=", 
      " ", 
      RowBox[{"{", 
       RowBox[{"num", "[", 
        RowBox[{"[", "m", "]"}], "]"}], "}"}]}], ";", " ", "\n", "       ", 
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"s_", ",", " ", "f_", ",", " ", "num_"}], "]"}], " ", ":=", 
      " ", 
      RowBox[{
       RowBox[{"h", "[", 
        RowBox[{"s", ",", " ", "f", ",", " ", "num"}], "]"}], " ", "=", " ", 
       RowBox[{"Flatten", "[", "\n", "          ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Outer", "[", 
           RowBox[{"F", ",", " ", 
            RowBox[{"{", 
             RowBox[{
             "Plus", ",", " ", "Subtract", ",", " ", "Times", ",", " ", 
              "divide"}], "}"}], ",", " ", 
            RowBox[{"h", "[", 
             RowBox[{"s", ",", " ", "i", ",", " ", "num"}], "]"}], ",", " ", 
            "\n", "            ", 
            RowBox[{"h", "[", 
             RowBox[{
              RowBox[{"i", " ", "+", " ", "1"}], ",", " ", "f", ",", " ", 
              "num"}], "]"}]}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "s", ",", " ", 
            RowBox[{"f", " ", "-", " ", "1"}]}], "}"}]}], "]"}], "]"}]}]}], 
     ";", " ", 
     RowBox[{
      RowBox[{"actionF", "[", 
       RowBox[{"op_", ",", " ", "n1_", ",", " ", "n2_"}], "]"}], " ", ":=", 
      " ", "\n", "        ", 
      RowBox[{"op", "[", 
       RowBox[{"n1", ",", " ", "n2"}], "]"}]}], ";", " ", 
     RowBox[{
      RowBox[{"printF", "[", 
       RowBox[{"op_", ",", " ", "n1_", ",", " ", "n2_"}], "]"}], " ", ":=", 
      " ", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<(\>\"", ",", " ", 
        RowBox[{"ToString", "[", "n1", "]"}], ",", " ", "\n", "         ", 
        RowBox[{"op", " ", "/.", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Times", " ", "->", " ", "\"\<\[Times]\>\""}], ",", " ", 
           RowBox[{"divide", " ", "->", " ", "\"\<\[Divide]\>\""}], ",", " ", 
           RowBox[{"Plus", " ", "->", " ", "\"\<+\>\""}], ",", " ", "\n", 
           "           ", 
           RowBox[{"Subtract", " ", "->", " ", "\"\<-\>\""}]}], "}"}]}], ",", 
        " ", 
        RowBox[{"ToString", "[", "n2", "]"}], ",", " ", "\"\<)\>\""}], 
       "]"}]}], ";", " ", "\n", "       ", 
     RowBox[{"temp", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"h", "[", 
           RowBox[{"1", ",", " ", "4", ",", " ", "#1"}], "]"}], " ", "&"}], 
         " ", ")"}], " ", "/@", " ", 
        RowBox[{"Permutations", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", " ", "b", ",", " ", "c", ",", " ", "d"}], "}"}], 
         "]"}]}], "]"}]}], ";", " ", "\n", "       ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#1", " ", "/.", " ", 
         RowBox[{"F", " ", "->", " ", "printF"}]}], " ", "&"}], " ", ")"}], 
      " ", "/@", " ", 
      RowBox[{"Select", "[", 
       RowBox[{"temp", ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#1", " ", "/.", " ", 
            RowBox[{"F", " ", "->", " ", "actionF"}]}], ")"}], " ", "==", " ",
           "\n", "           ", "goal"}], " ", "&"}]}], " ", "]"}]}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.722750629896695*^9, 3.7227506384618597`*^9}, 
   3.7227697325514116`*^9},ExpressionUUID->"4dfb6423-6e32-4659-9884-\
d2ec997b950c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Quiet", "@", 
    RowBox[{"point24", "[", 
     RowBox[{"{", 
      RowBox[{"3", ",", "7", ",", "6", ",", "1"}], "}"}], "]"}]}], "//", 
   "TT"}], "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.722750642022914*^9, 3.7227506644127803`*^9}, 
   3.7227573234585466`*^9, 
   3.722769736401111*^9},ExpressionUUID->"95e57147-b767-4aea-bf8d-\
093fe3e1cb2d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox["\<\"\:603b\:8fd0\:884c\:65f6: \"\>",
   "EchoLabel"], " ", "0.07739696437852056`"}]], "Echo",
 CellChangeTimes->{
  3.7227697375347214`*^9},ExpressionUUID->"7c81c1a1-b3ce-44ce-81e8-\
9414c26fdd42"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"CPU \:65f6\:95f4: \"\>",
   "EchoLabel"], " ", "0.078125`"}]], "Echo",
 CellChangeTimes->{
  3.7227697375527472`*^9},ExpressionUUID->"eb431528-6238-49db-9456-\
4e6bafc061d5"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {"\<\"((3\[Times](7-1))+6)\"\>"},
     {"\<\"((3\[Times]6)+(7-1))\"\>"},
     {"\<\"(((3\[Times]6)+7)-1)\"\>"},
     {"\<\"((3\[Times]6)-(1-7))\"\>"},
     {"\<\"(((3\[Times]6)-1)+7)\"\>"},
     {"\<\"(7+((3\[Times]6)-1))\"\>"},
     {"\<\"((7-3)\[Times](6\[Times]1))\"\>"},
     {"\<\"((7+(3\[Times]6))-1)\"\>"},
     {"\<\"(((7-3)\[Times]6)\[Times]1)\"\>"},
     {"\<\"((7-3)\[Times](1\[Times]6))\"\>"},
     {"\<\"((7-3)\[Divide](1\[Divide]6))\"\>"},
     {"\<\"((7-(3\[Times]1))\[Times]6)\"\>"},
     {"\<\"(((7-3)\[Times]1)\[Times]6)\"\>"},
     {"\<\"(7+((6\[Times]3)-1))\"\>"},
     {"\<\"((7+(6\[Times]3))-1)\"\>"},
     {"\<\"(7-(1-(3\[Times]6)))\"\>"},
     {"\<\"((7-1)+(3\[Times]6))\"\>"},
     {"\<\"(((7-1)\[Times]3)+6)\"\>"},
     {"\<\"((7-(1\[Times]3))\[Times]6)\"\>"},
     {"\<\"(((7\[Times]1)-3)\[Times]6)\"\>"},
     {"\<\"(7-(1-(6\[Times]3)))\"\>"},
     {"\<\"((7-1)+(6\[Times]3))\"\>"},
     {"\<\"((7+1)\[Times](6-3))\"\>"},
     {"\<\"(6+(3\[Times](7-1)))\"\>"},
     {"\<\"((6\[Times]3)+(7-1))\"\>"},
     {"\<\"((6-3)\[Times](7+1))\"\>"},
     {"\<\"(((6\[Times]3)+7)-1)\"\>"},
     {"\<\"(6-(3\[Times](1-7)))\"\>"},
     {"\<\"((6\[Times]3)-(1-7))\"\>"},
     {"\<\"((6-3)\[Times](1+7))\"\>"},
     {"\<\"(((6\[Times]3)-1)+7)\"\>"},
     {"\<\"(6\[Times](7-(3\[Times]1)))\"\>"},
     {"\<\"(6\[Times]((7-3)\[Times]1))\"\>"},
     {"\<\"((6\[Times](7-3))\[Times]1)\"\>"},
     {"\<\"(6+((7-1)\[Times]3))\"\>"},
     {"\<\"(6\[Times](7-(1\[Times]3)))\"\>"},
     {"\<\"(6\[Times]((7\[Times]1)-3))\"\>"},
     {"\<\"(6-((1-7)\[Times]3))\"\>"},
     {"\<\"(6\[Times](1\[Times](7-3)))\"\>"},
     {"\<\"(6\[Times]((1\[Times]7)-3))\"\>"},
     {"\<\"(6\[Divide](1\[Divide](7-3)))\"\>"},
     {"\<\"((6\[Times]1)\[Times](7-3))\"\>"},
     {"\<\"(1\[Times]((7-3)\[Times]6))\"\>"},
     {"\<\"((1\[Times](7-3))\[Times]6)\"\>"},
     {"\<\"(((1\[Times]7)-3)\[Times]6)\"\>"},
     {"\<\"((1+7)\[Times](6-3))\"\>"},
     {"\<\"(1\[Times](6\[Times](7-3)))\"\>"},
     {"\<\"((1\[Times]6)\[Times](7-3))\"\>"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.722750644619388*^9, 3.722750664938198*^9}, 
   3.7227573243940496`*^9, 
   3.722769737577768*^9},ExpressionUUID->"93695cfa-1504-44bf-a842-\
ab5d43454d70"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Poke24", "Section",
 CellChangeTimes->{
  3.722751048052615*^9},ExpressionUUID->"5ef90a20-afa1-4cc2-8984-\
14d76b7d78e3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Poke24", "[", "nums_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"toExprs", ",", "expand", ",", "next", ",", "exprs"}], "}"}], 
    ",", 
    RowBox[{
     RowBox[{
      RowBox[{"toExprs", "[", 
       RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"\"\<(\>\"", "<>", "#", "<>", "\"\<)\>\""}], "&"}], "/@", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x", "<>", "#", "<>", "y"}], ",", 
            RowBox[{"y", "<>", "#", "<>", "x"}]}], "}"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{
          "\"\<+\>\"", ",", "\"\<-\>\"", ",", "\"\<*\>\"", ",", "\"\</\>\""}],
           "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"expand", "[", "set_", "]"}], ":=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"sub", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Complement", "[", 
                RowBox[{"set", ",", "sub"}], "]"}], ",", "#"}], "]"}], "&"}], 
            "/@", 
            RowBox[{"toExprs", "@@", "sub"}]}]}], "]"}], "/@", 
         RowBox[{"Subsets", "[", 
          RowBox[{"set", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"next", "[", "sets_", "]"}], ":=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"expand", "/@", "sets"}], ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"exprs", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Nest", "[", 
        RowBox[{"next", ",", 
         RowBox[{"{", 
          RowBox[{"ToString", "/@", "nums"}], "}"}], ",", 
         RowBox[{
          RowBox[{"Length", "[", "nums", "]"}], "-", "1"}]}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"DeleteDuplicates", "[", "exprs", "]"}], ",", 
       RowBox[{
        RowBox[{"Quiet", "[", 
         RowBox[{
          RowBox[{"ToExpression", "[", "#", "]"}], "\[Equal]", "24"}], "]"}], 
        "&"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.722750831377653*^9, 
  3.7227508313806562`*^9}},ExpressionUUID->"0db11b42-b469-428d-925a-\
5c2f9e3f9cf9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Poke24", "[", 
    RowBox[{"{", 
     RowBox[{"3", ",", "7", ",", "6", ",", "1"}], "}"}], "]"}], "//", "TT"}], 
  "//", "TableForm"}]], "Input",
 CellChangeTimes->{3.722750840334982*^9, 
  3.72275733071987*^9},ExpressionUUID->"1df3b7e9-b5ab-425e-bb13-709c3d1180c7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox["\<\"\:603b\:8fd0\:884c\:65f6: \"\>",
   "EchoLabel"], " ", "0.1315910280562188`"}]], "Echo",
 CellChangeTimes->{
  3.7227573313458586`*^9},ExpressionUUID->"da22867b-0b3d-43b8-99f5-\
8ce947d71577"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"CPU \:65f6\:95f4: \"\>",
   "EchoLabel"], " ", "0.140625`"}]], "Echo",
 CellChangeTimes->{
  3.7227573313658743`*^9},ExpressionUUID->"49c77fa5-94de-4ba3-b687-\
54e0ecb96385"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {"\<\"((7-3)*(1*6))\"\>"},
     {"\<\"((1*6)*(7-3))\"\>"},
     {"\<\"((7-3)*(6*1))\"\>"},
     {"\<\"((6*1)*(7-3))\"\>"},
     {"\<\"((7-3)/(1/6))\"\>"},
     {"\<\"((7-3)*(6/1))\"\>"},
     {"\<\"((6/1)*(7-3))\"\>"},
     {"\<\"(6*(1*(7-3)))\"\>"},
     {"\<\"((1*(7-3))*6)\"\>"},
     {"\<\"(6*((7-3)*1))\"\>"},
     {"\<\"(((7-3)*1)*6)\"\>"},
     {"\<\"(6/(1/(7-3)))\"\>"},
     {"\<\"(6*((7-3)/1))\"\>"},
     {"\<\"(((7-3)/1)*6)\"\>"},
     {"\<\"(1*(6*(7-3)))\"\>"},
     {"\<\"((6*(7-3))*1)\"\>"},
     {"\<\"((6*(7-3))/1)\"\>"},
     {"\<\"(1*((7-3)*6))\"\>"},
     {"\<\"(((7-3)*6)*1)\"\>"},
     {"\<\"(((7-3)*6)/1)\"\>"},
     {"\<\"((6-3)*(1+7))\"\>"},
     {"\<\"((1+7)*(6-3))\"\>"},
     {"\<\"((6-3)*(7+1))\"\>"},
     {"\<\"((7+1)*(6-3))\"\>"},
     {"\<\"((3*6)-(1-7))\"\>"},
     {"\<\"((3*6)+(7-1))\"\>"},
     {"\<\"((7-1)+(3*6))\"\>"},
     {"\<\"(7-(1-(3*6)))\"\>"},
     {"\<\"(7+((3*6)-1))\"\>"},
     {"\<\"(((3*6)-1)+7)\"\>"},
     {"\<\"((7+(3*6))-1)\"\>"},
     {"\<\"(((3*6)+7)-1)\"\>"},
     {"\<\"((6*3)-(1-7))\"\>"},
     {"\<\"((6*3)+(7-1))\"\>"},
     {"\<\"((7-1)+(6*3))\"\>"},
     {"\<\"(7-(1-(6*3)))\"\>"},
     {"\<\"(7+((6*3)-1))\"\>"},
     {"\<\"(((6*3)-1)+7)\"\>"},
     {"\<\"((7+(6*3))-1)\"\>"},
     {"\<\"(((6*3)+7)-1)\"\>"},
     {"\<\"(6*(7-(3*1)))\"\>"},
     {"\<\"((7-(3*1))*6)\"\>"},
     {"\<\"(6*(7-(1*3)))\"\>"},
     {"\<\"((7-(1*3))*6)\"\>"},
     {"\<\"(6*(7-(3/1)))\"\>"},
     {"\<\"((7-(3/1))*6)\"\>"},
     {"\<\"(6+(3*(7-1)))\"\>"},
     {"\<\"((3*(7-1))+6)\"\>"},
     {"\<\"(6+((7-1)*3))\"\>"},
     {"\<\"(((7-1)*3)+6)\"\>"},
     {"\<\"(6-(3*(1-7)))\"\>"},
     {"\<\"(6-((1-7)*3))\"\>"},
     {"\<\"(6*((7*1)-3))\"\>"},
     {"\<\"(((7*1)-3)*6)\"\>"},
     {"\<\"(6*((1*7)-3))\"\>"},
     {"\<\"(((1*7)-3)*6)\"\>"},
     {"\<\"(6*((7/1)-3))\"\>"},
     {"\<\"(((7/1)-3)*6)\"\>"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7227508411250925`*^9, 3.722751045222492*^9, 
  3.7227573313848753`*^9},ExpressionUUID->"a9a26b2b-0932-4bf0-a3c1-\
e13b1be8ad73"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cal24", "[", "nums_List", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ops", ",", 
      RowBox[{"num", "=", "nums"}], ",", "rule", ",", "same", ",", "filter"}],
      "}"}], ",", 
    RowBox[{
     RowBox[{"ops", "=", 
      RowBox[{"{", 
       RowBox[{"Plus", ",", "Subtract", ",", "Times", ",", "Divide"}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rule", "=", 
      RowBox[{"Thread", "[", 
       RowBox[{"num", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z", ",", "w"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"same", "[", 
       RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p", ",", "q"}], "}"}], ",", 
        RowBox[{
         RowBox[{"p", "=", 
          RowBox[{"a", "/.", "rule"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"q", "=", 
          RowBox[{"b", "/.", "rule"}]}], ";", 
         RowBox[{
          RowBox[{"ReleaseHold", "[", "p", "]"}], "===", 
          RowBox[{"ReleaseHold", "[", "q", "]"}]}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"filter", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"op1_", ",", "op2_", ",", "op3_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "}"}]}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ans", "=", 
          RowBox[{"{", "}"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Quiet", "@", 
             RowBox[{"op1", "[", 
              RowBox[{
               RowBox[{"op2", "[", 
                RowBox[{
                 RowBox[{"op3", "[", 
                  RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
               "d"}], "]"}]}], "\[Equal]", "24"}], ",", 
           RowBox[{
            RowBox[{"ans", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"ans", ",", 
               RowBox[{"{", 
                RowBox[{"HoldForm", "@", 
                 RowBox[{"op1", "[", 
                  RowBox[{
                   RowBox[{"op2", "[", 
                    RowBox[{
                    RowBox[{"op3", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                   "d"}], "]"}]}], "}"}]}], "]"}]}], ";"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Quiet", "@", 
             RowBox[{"op1", "[", 
              RowBox[{
               RowBox[{"op2", "[", 
                RowBox[{"a", ",", "b"}], "]"}], ",", 
               RowBox[{"op3", "[", 
                RowBox[{"c", ",", "d"}], "]"}]}], "]"}]}], "\[Equal]", "24"}],
            ",", 
           RowBox[{
            RowBox[{"ans", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"ans", ",", 
               RowBox[{"{", 
                RowBox[{"HoldForm", "@", 
                 RowBox[{"op1", "[", 
                  RowBox[{
                   RowBox[{"op2", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", 
                   RowBox[{"op3", "[", 
                    RowBox[{"c", ",", "d"}], "]"}]}], "]"}]}], "}"}]}], 
              "]"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Quiet", "@", 
             RowBox[{"op1", "[", 
              RowBox[{
               RowBox[{"op2", "[", 
                RowBox[{"a", ",", 
                 RowBox[{"op3", "[", 
                  RowBox[{"b", ",", "c"}], "]"}]}], "]"}], ",", "d"}], 
              "]"}]}], "\[Equal]", "24"}], ",", 
           RowBox[{
            RowBox[{"ans", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"ans", ",", 
               RowBox[{"{", 
                RowBox[{"HoldForm", "@", 
                 RowBox[{"op1", "[", 
                  RowBox[{
                   RowBox[{"op2", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{"op3", "[", 
                    RowBox[{"b", ",", "c"}], "]"}]}], "]"}], ",", "d"}], 
                  "]"}]}], "}"}]}], "]"}]}], ";"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Quiet", "@", 
             RowBox[{"op1", "[", 
              RowBox[{"a", ",", 
               RowBox[{"op2", "[", 
                RowBox[{"b", ",", 
                 RowBox[{"op3", "[", 
                  RowBox[{"c", ",", "d"}], "]"}]}], "]"}]}], "]"}]}], 
            "\[Equal]", "24"}], ",", 
           RowBox[{
            RowBox[{"ans", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"ans", ",", 
               RowBox[{"{", 
                RowBox[{"HoldForm", "@", 
                 RowBox[{"op1", "[", 
                  RowBox[{"a", ",", 
                   RowBox[{"op2", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"op3", "[", 
                    RowBox[{"c", ",", "d"}], "]"}]}], "]"}]}], "]"}]}], 
                "}"}]}], "]"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
         "ans"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{
       RowBox[{"Union", "@@", 
        RowBox[{"filter", "@@@", 
         RowBox[{"Tuples", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{"ops", ",", "3"}], "]"}], ",", 
            RowBox[{"Permutations", "[", "num", "]"}]}], "}"}], "]"}]}]}], 
       ",", "same"}], "]"}]}]}], "]"}]}], "\n", 
 RowBox[{"cal24", "[", 
  RowBox[{"{", 
   RowBox[{"2", ",", "3", ",", "5", ",", "7"}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7227509350638514`*^9, 
  3.7227509350668535`*^9}},ExpressionUUID->"15ad0089-1418-4b70-8c88-\
e659a3ee5bf7"]
}, Closed]],

Cell[CellGroupData[{

Cell["cal24", "Section",
 CellChangeTimes->{
  3.7227697545731583`*^9},ExpressionUUID->"a0e47a12-79c3-4e9a-9053-\
bbfe6bae5730"],

Cell[CellGroupData[{

Cell[BoxData["Quit"], "Input",
 CellChangeTimes->{{3.722762545800881*^9, 
  3.7227625716375256`*^9}},ExpressionUUID->"359ac8a6-b74c-460a-9d1c-\
44eb64ff13c9"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"\:6240\:6709\:4e34\:65f6\:5b9a\:4e49\:5df2\:6e05\:7a7a!\"\>",
   "EchoLabel"], " ", "\<\"\"\>"}]], "Echo",
 CellChangeTimes->{
  3.722762546491535*^9},ExpressionUUID->"777057a7-7ceb-4237-ae8a-\
0a58cfc4a9ff"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"cal24", "[", "nums_List", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ops", ",", 
      RowBox[{"num", "=", "nums"}], ",", "rule", ",", "same", ",", "filter"}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ops", "=", 
      RowBox[{"{", 
       RowBox[{"Plus", ",", "Subtract", ",", "Times", ",", "Divide"}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rule", "=", 
      RowBox[{"Thread", "[", 
       RowBox[{"num", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z", ",", "w"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"same", "[", 
       RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p", ",", "q"}], "}"}], ",", 
        RowBox[{
         RowBox[{"p", "=", 
          RowBox[{"a", "/.", "rule"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"q", "=", 
          RowBox[{"b", "/.", "rule"}]}], ";", 
         RowBox[{
          RowBox[{"ReleaseHold", "[", "p", "]"}], "===", 
          RowBox[{"ReleaseHold", "[", "q", "]"}]}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"filter", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"op1_", ",", "op2_", ",", "op3_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "}"}]}], "]"}], ":=", 
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ans", "=", 
          RowBox[{"{", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Quiet", "@", 
             RowBox[{"op1", "[", 
              RowBox[{
               RowBox[{"op2", "[", 
                RowBox[{
                 RowBox[{"op3", "[", 
                  RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
               "d"}], "]"}]}], "\[Equal]", "24"}], ",", 
           RowBox[{
            RowBox[{"ans", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"ans", ",", 
               RowBox[{"{", 
                RowBox[{"HoldForm", "@", 
                 RowBox[{"op1", "[", 
                  RowBox[{
                   RowBox[{"op2", "[", 
                    RowBox[{
                    RowBox[{"op3", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                   "d"}], "]"}]}], "}"}]}], "]"}]}], ";"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Quiet", "@", 
             RowBox[{"op1", "[", 
              RowBox[{
               RowBox[{"op2", "[", 
                RowBox[{"a", ",", "b"}], "]"}], ",", 
               RowBox[{"op3", "[", 
                RowBox[{"c", ",", "d"}], "]"}]}], "]"}]}], "\[Equal]", "24"}],
            ",", 
           RowBox[{
            RowBox[{"ans", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"ans", ",", 
               RowBox[{"{", 
                RowBox[{"HoldForm", "@", 
                 RowBox[{"op1", "[", 
                  RowBox[{
                   RowBox[{"op2", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", 
                   RowBox[{"op3", "[", 
                    RowBox[{"c", ",", "d"}], "]"}]}], "]"}]}], "}"}]}], 
              "]"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Quiet", "@", 
             RowBox[{"op1", "[", 
              RowBox[{
               RowBox[{"op2", "[", 
                RowBox[{"a", ",", 
                 RowBox[{"op3", "[", 
                  RowBox[{"b", ",", "c"}], "]"}]}], "]"}], ",", "d"}], 
              "]"}]}], "\[Equal]", "24"}], ",", 
           RowBox[{
            RowBox[{"ans", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"ans", ",", 
               RowBox[{"{", 
                RowBox[{"HoldForm", "@", 
                 RowBox[{"op1", "[", 
                  RowBox[{
                   RowBox[{"op2", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{"op3", "[", 
                    RowBox[{"b", ",", "c"}], "]"}]}], "]"}], ",", "d"}], 
                  "]"}]}], "}"}]}], "]"}]}], ";"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Quiet", "@", 
             RowBox[{"op1", "[", 
              RowBox[{"a", ",", 
               RowBox[{"op2", "[", 
                RowBox[{
                 RowBox[{"op3", "[", 
                  RowBox[{"b", ",", "c"}], "]"}], ",", "d"}], "]"}]}], 
              "]"}]}], "\[Equal]", "24"}], ",", 
           RowBox[{
            RowBox[{"ans", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"ans", ",", 
               RowBox[{"{", 
                RowBox[{"HoldForm", "@", 
                 RowBox[{"op1", "[", 
                  RowBox[{"a", ",", 
                   RowBox[{"op2", "[", 
                    RowBox[{
                    RowBox[{"op3", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], ",", "d"}], "]"}]}], 
                  "]"}]}], "}"}]}], "]"}]}], ";"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Quiet", "@", 
             RowBox[{"op1", "[", 
              RowBox[{"a", ",", 
               RowBox[{"op2", "[", 
                RowBox[{"b", ",", 
                 RowBox[{"op3", "[", 
                  RowBox[{"c", ",", "d"}], "]"}]}], "]"}]}], "]"}]}], 
            "\[Equal]", "24"}], ",", 
           RowBox[{
            RowBox[{"ans", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"ans", ",", 
               RowBox[{"{", 
                RowBox[{"HoldForm", "@", 
                 RowBox[{"op1", "[", 
                  RowBox[{"a", ",", 
                   RowBox[{"op2", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"op3", "[", 
                    RowBox[{"c", ",", "d"}], "]"}]}], "]"}]}], "]"}]}], 
                "}"}]}], "]"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
         "ans"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{
       RowBox[{"Union", "@@", 
        RowBox[{"filter", "@@@", 
         RowBox[{"Tuples", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{"ops", ",", "3"}], "]"}], ",", 
            RowBox[{"Permutations", "[", "num", "]"}]}], "}"}], "]"}]}]}], 
       ",", "same"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.722750629896695*^9, 3.7227506384618597`*^9}, {
  3.7227510659777145`*^9, 3.7227510692111444`*^9}, {3.7227511751246977`*^9, 
  3.7227511755431175`*^9}, {3.722757880814502*^9, 3.7227578836941833`*^9}, {
  3.722761655897828*^9, 3.7227617217541084`*^9}, {3.7227617810932283`*^9, 
  3.7227617821893387`*^9}, {3.722762172298827*^9, 3.7227622060830765`*^9}, {
  3.7227628797159195`*^9, 
  3.722762922393431*^9}},ExpressionUUID->"89190d68-8c41-4fc8-8c7b-\
cfb618f7a575"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cal24", "[", 
     RowBox[{"{", 
      RowBox[{"3", ",", "5", ",", "7", ",", "1"}], "}"}], "]"}], "/.", 
    RowBox[{
     RowBox[{"HoldForm", "[", "x__", "]"}], "\[RuleDelayed]", 
     RowBox[{"HoldForm", "[", 
      RowBox[{"InputForm", "[", "x", "]"}], "]"}]}]}], "//", "TableForm"}], "//",
   "TT"}]], "Input",
 CellChangeTimes->{{3.722750642022914*^9, 3.7227506644127803`*^9}, 
   3.722751072486038*^9, 3.722757337824506*^9, 3.722761637423958*^9, 
   3.722761674896062*^9, {3.722761827036135*^9, 3.7227618300565042`*^9}, {
   3.722762465586049*^9, 3.7227624694412336`*^9}, 3.722762532777153*^9, {
   3.7227625854358835`*^9, 3.722762615619322*^9}, {3.722762766895601*^9, 
   3.7227627752516017`*^9}, 3.7227628530623755`*^9, {3.722762939924328*^9, 
   3.7227629660473676`*^9}, {3.722763007947606*^9, 
   3.7227630240280538`*^9}},ExpressionUUID->"91822627-1337-4a94-9c1c-\
a2527b6d771e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox["\<\"\:603b\:8fd0\:884c\:65f6: \"\>",
   "EchoLabel"], " ", "0.0405615722455332`"}]], "Echo",
 CellChangeTimes->{
  3.7227630245159006`*^9},ExpressionUUID->"b6b11927-dda7-4771-aad9-\
74dd04aff0e0"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"CPU \:65f6\:95f4: \"\>",
   "EchoLabel"], " ", "0.046875`"}]], "Echo",
 CellChangeTimes->{
  3.7227630245283966`*^9},ExpressionUUID->"0d6a86cd-0c74-4681-b339-\
b7e5e6dec104"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      TagBox[
       InterpretationBox[
        StyleBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{"7", " ", "-", " ", "3"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"5", " ", "+", " ", "1"}], ")"}]}],
         ShowStringCharacters->True,
         NumberMarks->True],
        InputForm[Subtract[7, 3] (5 + 1)],
        AutoDelete->True,
        Editable->True],
       HoldForm]},
     {
      TagBox[
       InterpretationBox[
        StyleBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{"3", " ", "-", " ", "1"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"7", " ", "+", " ", "5"}], ")"}]}],
         ShowStringCharacters->True,
         NumberMarks->True],
        InputForm[Subtract[3, 1] (7 + 5)],
        AutoDelete->True,
        Editable->True],
       HoldForm]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.722750644619388*^9, 3.722750664938198*^9}, 
   3.7227510735825925`*^9, 3.722751126411598*^9, 3.7227511790365047`*^9, 
   3.7227570889415708`*^9, 3.7227573384850817`*^9, {3.7227616236334476`*^9, 
   3.7227616249270544`*^9}, {3.7227616730375752`*^9, 
   3.7227616763226967`*^9}, {3.722761777126526*^9, 3.72276178474741*^9}, 
   3.72276183068469*^9, {3.722762199092066*^9, 3.7227622079499483`*^9}, {
   3.722762460811884*^9, 3.7227624826700077`*^9}, {3.722762534046262*^9, 
   3.7227625488223467`*^9}, {3.722762579643652*^9, 3.722762620659236*^9}, {
   3.7227627716754613`*^9, 3.722762775729761*^9}, {3.72276285362481*^9, 
   3.7227628571775274`*^9}, {3.7227629024026184`*^9, 3.72276296652411*^9}, {
   3.722763009661214*^9, 
   3.722763024547926*^9}},ExpressionUUID->"4e406e45-fc52-468c-88ad-\
f295ea27b94e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"op1", "[", 
    RowBox[{
     RowBox[{"op2", "[", 
      RowBox[{
       RowBox[{"op3", "[", 
        RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", "d"}], "]"}], 
   "\[Equal]", "24"}], ",", "\[IndentingNewLine]", 
  RowBox[{"op1", "[", 
   RowBox[{
    RowBox[{"op2", "[", 
     RowBox[{
      RowBox[{"op3", "[", 
       RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", "d"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7227573709807606`*^9, 
  3.7227573790036726`*^9}},ExpressionUUID->"cbd02068-2ec3-45ff-b853-\
6b8548bafba9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"treeR", "[", "1", "]"}], "=", "n"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"treeR", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"treeR", "[", "n", "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"o", "[", 
      RowBox[{
       RowBox[{"treeR", "[", "a", "]"}], ",", 
       RowBox[{"treeR", "[", 
        RowBox[{"n", "-", "a"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "1", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"tree", "[", "n_", "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"treeR", "[", "n", "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"o", "[", 
        RowBox[{"a_List", ",", "b_"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"o", "[", 
           RowBox[{"#", ",", "b"}], "]"}], "&"}], "/@", "a"}], ")"}]}], ",", 
      RowBox[{
       RowBox[{"o", "[", 
        RowBox[{"a_", ",", "b_List"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"o", "[", 
           RowBox[{"a", ",", "#"}], "]"}], "&"}], "/@", "b"}], ")"}]}]}], 
     "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tree", "[", "4", "]"}], "//", "TableForm"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nn", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ToExpression", "[", 
       RowBox[{"\"\<n\>\"", "<>", 
        RowBox[{"ToString", "@", "#"}]}], "]"}], "&"}], ",", "4"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"oo", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ToExpression", "[", 
       RowBox[{"\"\<o\>\"", "<>", 
        RowBox[{"ToString", "@", "#"}]}], "]"}], "&"}], ",", 
     RowBox[{"4", "-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ff", "=", 
    RowBox[{
     RowBox[{"ReplacePart", "[", 
      RowBox[{"#", ",", 
       RowBox[{
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"#", ",", "n"}], "]"}], "\[Rule]", "nn"}], "]"}], "~", 
        "Join", "~", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"#", ",", "o"}], "]"}], "\[Rule]", "oo"}], "]"}]}]}], 
      "]"}], "&"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fs", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Quiet", "@", "#"}], "\[Equal]", "24"}], ",", 
       RowBox[{
        RowBox[{"ans", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"ans", ",", 
           RowBox[{"{", 
            RowBox[{"HoldForm", "@", "#"}], "}"}]}], "]"}]}], ";"}]}], "]"}], 
     "&"}], "/@", 
    RowBox[{"(", 
     RowBox[{"ff", "/@", 
      RowBox[{"tree", "[", "4", "]"}]}], ")"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StringReplace", "[", 
   RowBox[{
    RowBox[{"ToString", "@", "fs"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<; ],\>\"", "->", "\"\<; ];\\n\>\""}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"\"\<{\>\"", "\[Rule]", 
  "\"\<{ans={}},\\n\>\""}], "\[IndentingNewLine]", 
 RowBox[{"\"\<}\>\"", "\[Rule]", "\"\<\\n ans}\>\""}]}], "Input",
 CellChangeTimes->{{3.722757454801773*^9, 3.7227574626143537`*^9}, {
   3.72275766660441*^9, 3.7227577305293627`*^9}, {3.7227586860614567`*^9, 
   3.722758716645887*^9}, {3.7227606482658224`*^9, 3.722760648626194*^9}, {
   3.7227606873415136`*^9, 3.7227607165416284`*^9}, 3.7227607732088814`*^9, {
   3.722760815811741*^9, 3.722760816849637*^9}, {3.7227610536701927`*^9, 
   3.722761056448586*^9}, {3.722761154077674*^9, 3.7227611972598495`*^9}, {
   3.7227612419551373`*^9, 3.7227613068011937`*^9}, {3.722761417134508*^9, 
   3.7227614175213394`*^9}, 3.7227622141676216`*^9, {3.7227626762208714`*^9, 
   3.7227626773153286`*^9}, {3.7227676827711897`*^9, 
   3.7227679265632477`*^9}},ExpressionUUID->"36aea2c4-6775-48d1-8fed-\
b0f3041c5564"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{"o", "[", 
       RowBox[{"n", ",", 
        RowBox[{"o", "[", 
         RowBox[{"n", ",", 
          RowBox[{"o", "[", 
           RowBox[{"n", ",", "n"}], "]"}]}], "]"}]}], "]"}]},
     {
      RowBox[{"o", "[", 
       RowBox[{"n", ",", 
        RowBox[{"o", "[", 
         RowBox[{
          RowBox[{"o", "[", 
           RowBox[{"n", ",", "n"}], "]"}], ",", "n"}], "]"}]}], "]"}]},
     {
      RowBox[{"o", "[", 
       RowBox[{
        RowBox[{"o", "[", 
         RowBox[{"n", ",", "n"}], "]"}], ",", 
        RowBox[{"o", "[", 
         RowBox[{"n", ",", "n"}], "]"}]}], "]"}]},
     {
      RowBox[{"o", "[", 
       RowBox[{
        RowBox[{"o", "[", 
         RowBox[{"n", ",", 
          RowBox[{"o", "[", 
           RowBox[{"n", ",", "n"}], "]"}]}], "]"}], ",", "n"}], "]"}]},
     {
      RowBox[{"o", "[", 
       RowBox[{
        RowBox[{"o", "[", 
         RowBox[{
          RowBox[{"o", "[", 
           RowBox[{"n", ",", "n"}], "]"}], ",", "n"}], "]"}], ",", "n"}], 
       "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.722757458192565*^9, 3.7227574628326936`*^9}, {
   3.7227576772732844`*^9, 3.722757730782072*^9}, {3.722758673444269*^9, 
   3.7227587178219275`*^9}, {3.7227606488700943`*^9, 3.722760658160364*^9}, {
   3.7227606881620417`*^9, 3.7227607182662306`*^9}, {3.7227607578834634`*^9, 
   3.722760773573807*^9}, 3.7227608170888605`*^9, 3.722761125269224*^9, {
   3.7227611815022144`*^9, 3.7227611992948303`*^9}, {3.722761242885271*^9, 
   3.722761312052364*^9}, 3.72276141823514*^9, {3.7227622113101563`*^9, 
   3.7227622146047974`*^9}, {3.722767680201835*^9, 3.722767685977903*^9}, {
   3.7227677321095066`*^9, 3.722767777533145*^9}, {3.722767824288247*^9, 
   3.7227678735394707`*^9}, {3.722767921840625*^9, 
   3.722767927360975*^9}},ExpressionUUID->"7d0ec301-ac32-4036-9087-\
6579a21fc81f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"o1", "[", 
       RowBox[{"n1", ",", 
        RowBox[{"o2", "[", 
         RowBox[{"n2", ",", 
          RowBox[{"o3", "[", 
           RowBox[{"n3", ",", "n4"}], "]"}]}], "]"}]}], "]"}], "\[Equal]", 
      "24"}], ",", 
     RowBox[{
      RowBox[{"ans", "=", 
       RowBox[{"ans", "\[Union]", 
        RowBox[{"{", 
         TagBox[
          RowBox[{"o1", "[", 
           RowBox[{"n1", ",", 
            RowBox[{"o2", "[", 
             RowBox[{"n2", ",", 
              RowBox[{"o3", "[", 
               RowBox[{"n3", ",", "n4"}], "]"}]}], "]"}]}], "]"}],
          HoldForm], "}"}]}]}], ";"}]}], "]"}], ",", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"o1", "[", 
       RowBox[{"n1", ",", 
        RowBox[{"o2", "[", 
         RowBox[{
          RowBox[{"o3", "[", 
           RowBox[{"n2", ",", "n3"}], "]"}], ",", "n4"}], "]"}]}], "]"}], 
      "\[Equal]", "24"}], ",", 
     RowBox[{
      RowBox[{"ans", "=", 
       RowBox[{"ans", "\[Union]", 
        RowBox[{"{", 
         TagBox[
          RowBox[{"o1", "[", 
           RowBox[{"n1", ",", 
            RowBox[{"o2", "[", 
             RowBox[{
              RowBox[{"o3", "[", 
               RowBox[{"n2", ",", "n3"}], "]"}], ",", "n4"}], "]"}]}], "]"}],
          HoldForm], "}"}]}]}], ";"}]}], "]"}], ",", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"o1", "[", 
       RowBox[{
        RowBox[{"o2", "[", 
         RowBox[{"n1", ",", "n2"}], "]"}], ",", 
        RowBox[{"o3", "[", 
         RowBox[{"n3", ",", "n4"}], "]"}]}], "]"}], "\[Equal]", "24"}], ",", 
     RowBox[{
      RowBox[{"ans", "=", 
       RowBox[{"ans", "\[Union]", 
        RowBox[{"{", 
         TagBox[
          RowBox[{"o1", "[", 
           RowBox[{
            RowBox[{"o2", "[", 
             RowBox[{"n1", ",", "n2"}], "]"}], ",", 
            RowBox[{"o3", "[", 
             RowBox[{"n3", ",", "n4"}], "]"}]}], "]"}],
          HoldForm], "}"}]}]}], ";"}]}], "]"}], ",", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"o1", "[", 
       RowBox[{
        RowBox[{"o2", "[", 
         RowBox[{"n1", ",", 
          RowBox[{"o3", "[", 
           RowBox[{"n2", ",", "n3"}], "]"}]}], "]"}], ",", "n4"}], "]"}], 
      "\[Equal]", "24"}], ",", 
     RowBox[{
      RowBox[{"ans", "=", 
       RowBox[{"ans", "\[Union]", 
        RowBox[{"{", 
         TagBox[
          RowBox[{"o1", "[", 
           RowBox[{
            RowBox[{"o2", "[", 
             RowBox[{"n1", ",", 
              RowBox[{"o3", "[", 
               RowBox[{"n2", ",", "n3"}], "]"}]}], "]"}], ",", "n4"}], "]"}],
          HoldForm], "}"}]}]}], ";"}]}], "]"}], ",", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"o1", "[", 
       RowBox[{
        RowBox[{"o2", "[", 
         RowBox[{
          RowBox[{"o3", "[", 
           RowBox[{"n1", ",", "n2"}], "]"}], ",", "n3"}], "]"}], ",", "n4"}], 
       "]"}], "\[Equal]", "24"}], ",", 
     RowBox[{
      RowBox[{"ans", "=", 
       RowBox[{"ans", "\[Union]", 
        RowBox[{"{", 
         TagBox[
          RowBox[{"o1", "[", 
           RowBox[{
            RowBox[{"o2", "[", 
             RowBox[{
              RowBox[{"o3", "[", 
               RowBox[{"n1", ",", "n2"}], "]"}], ",", "n3"}], "]"}], ",", 
            "n4"}], "]"}],
          HoldForm], "}"}]}]}], ";"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.722757458192565*^9, 3.7227574628326936`*^9}, {
   3.7227576772732844`*^9, 3.722757730782072*^9}, {3.722758673444269*^9, 
   3.7227587178219275`*^9}, {3.7227606488700943`*^9, 3.722760658160364*^9}, {
   3.7227606881620417`*^9, 3.7227607182662306`*^9}, {3.7227607578834634`*^9, 
   3.722760773573807*^9}, 3.7227608170888605`*^9, 3.722761125269224*^9, {
   3.7227611815022144`*^9, 3.7227611992948303`*^9}, {3.722761242885271*^9, 
   3.722761312052364*^9}, 3.72276141823514*^9, {3.7227622113101563`*^9, 
   3.7227622146047974`*^9}, {3.722767680201835*^9, 3.722767685977903*^9}, {
   3.7227677321095066`*^9, 3.722767777533145*^9}, {3.722767824288247*^9, 
   3.7227678735394707`*^9}, {3.722767921840625*^9, 
   3.7227679273674784`*^9}},ExpressionUUID->"4640ecb6-f6e5-46cb-b773-\
825b47fb0dba"],

Cell[BoxData["\<\"{If[o1[n1, o2[n2, o3[n3, n4]]] == 24, ans = Union[ans, \
{o1[n1, o2[n2, o3[n3, n4]]]}]; ];\\n If[o1[n1, o2[o3[n2, n3], n4]] == 24, ans \
= Union[ans, {o1[n1, o2[o3[n2, n3], n4]]}]; ];\\n If[o1[o2[n1, n2], o3[n3, \
n4]] == 24, ans = Union[ans, {o1[o2[n1, n2], o3[n3, n4]]}]; ];\\n \
If[o1[o2[n1, o3[n2, n3]], n4] == 24, ans = Union[ans, {o1[o2[n1, o3[n2, n3]], \
n4]}]; ];\\n If[o1[o2[o3[n1, n2], n3], n4] == 24, ans = Union[ans, \
{o1[o2[o3[n1, n2], n3], n4]}]; ]}\"\>"], "Output",
 CellChangeTimes->{{3.722757458192565*^9, 3.7227574628326936`*^9}, {
   3.7227576772732844`*^9, 3.722757730782072*^9}, {3.722758673444269*^9, 
   3.7227587178219275`*^9}, {3.7227606488700943`*^9, 3.722760658160364*^9}, {
   3.7227606881620417`*^9, 3.7227607182662306`*^9}, {3.7227607578834634`*^9, 
   3.722760773573807*^9}, 3.7227608170888605`*^9, 3.722761125269224*^9, {
   3.7227611815022144`*^9, 3.7227611992948303`*^9}, {3.722761242885271*^9, 
   3.722761312052364*^9}, 3.72276141823514*^9, {3.7227622113101563`*^9, 
   3.7227622146047974`*^9}, {3.722767680201835*^9, 3.722767685977903*^9}, {
   3.7227677321095066`*^9, 3.722767777533145*^9}, {3.722767824288247*^9, 
   3.7227678735394707`*^9}, {3.722767921840625*^9, 
   3.7227679273724823`*^9}},ExpressionUUID->"e03c474a-dfd3-405d-b9ed-\
97dd4ad57902"],

Cell[BoxData[
 RowBox[{"\<\"{\"\>", "\[Rule]", "\<\"{ans={}},\\n\"\>"}]], "Output",
 CellChangeTimes->{{3.722757458192565*^9, 3.7227574628326936`*^9}, {
   3.7227576772732844`*^9, 3.722757730782072*^9}, {3.722758673444269*^9, 
   3.7227587178219275`*^9}, {3.7227606488700943`*^9, 3.722760658160364*^9}, {
   3.7227606881620417`*^9, 3.7227607182662306`*^9}, {3.7227607578834634`*^9, 
   3.722760773573807*^9}, 3.7227608170888605`*^9, 3.722761125269224*^9, {
   3.7227611815022144`*^9, 3.7227611992948303`*^9}, {3.722761242885271*^9, 
   3.722761312052364*^9}, 3.72276141823514*^9, {3.7227622113101563`*^9, 
   3.7227622146047974`*^9}, {3.722767680201835*^9, 3.722767685977903*^9}, {
   3.7227677321095066`*^9, 3.722767777533145*^9}, {3.722767824288247*^9, 
   3.7227678735394707`*^9}, {3.722767921840625*^9, 
   3.722767927375984*^9}},ExpressionUUID->"b8e7a60c-bf36-4a3f-a351-\
129898ccce7f"],

Cell[BoxData[
 RowBox[{"\<\"}\"\>", "\[Rule]", "\<\"\\n ans}\"\>"}]], "Output",
 CellChangeTimes->{{3.722757458192565*^9, 3.7227574628326936`*^9}, {
   3.7227576772732844`*^9, 3.722757730782072*^9}, {3.722758673444269*^9, 
   3.7227587178219275`*^9}, {3.7227606488700943`*^9, 3.722760658160364*^9}, {
   3.7227606881620417`*^9, 3.7227607182662306`*^9}, {3.7227607578834634`*^9, 
   3.722760773573807*^9}, 3.7227608170888605`*^9, 3.722761125269224*^9, {
   3.7227611815022144`*^9, 3.7227611992948303`*^9}, {3.722761242885271*^9, 
   3.722761312052364*^9}, 3.72276141823514*^9, {3.7227622113101563`*^9, 
   3.7227622146047974`*^9}, {3.722767680201835*^9, 3.722767685977903*^9}, {
   3.7227677321095066`*^9, 3.722767777533145*^9}, {3.722767824288247*^9, 
   3.7227678735394707`*^9}, {3.722767921840625*^9, 
   3.7227679273789873`*^9}},ExpressionUUID->"1cfdd644-9c99-486e-a963-\
bb7a74084471"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["CC"], "Input",
 CellChangeTimes->{
  3.7227587067791615`*^9},ExpressionUUID->"d541cf2e-4bc8-4229-a42f-\
f4c5294891fe"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"\:6240\:6709\:4e34\:65f6\:5b9a\:4e49\:5df2\:6e05\:7a7a!\"\>",
   "EchoLabel"], " ", "\<\"\"\>"}]], "Echo",
 CellChangeTimes->{
  3.722758707158899*^9},ExpressionUUID->"6d68ab79-5aee-4eef-b0ad-\
241c7880f7b5"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"metaFilter", "[", "n_Integer", "]"}], ":=", 
  RowBox[{
  "Block", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.722757830186322*^9, 
  3.7227579024849296`*^9}},ExpressionUUID->"e2323887-a5d8-4b87-ab59-\
b82e40f84da8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Function", "[", 
      RowBox[{"z", ",", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Flatten", "@", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Through", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"Fold", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "\"\<(\>\"", "<>", "#1", "<>", "#2", "<>", "\"\<)\>\""}], 
                    "&"}], ",", "x", ",", "#"}], "]"}]}], "]"}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{"x1", ",", 
                    RowBox[{"Inner", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#1", "<>", "#2"}], "&"}], ",", "x1", ",", "y", 
                    ",", "List"}], "]"}]}], "]"}], "/@", 
                    RowBox[{"Tuples", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<+\>\"", ",", "\"\<-\>\"", ",", "\"\<*\>\"", ",", 
                    "\"\</\>\""}], "}"}], ",", "3"}], "]"}]}]}], "]"}], "[", 
                    "#", "]"}]}], "&"}], "[", 
                  RowBox[{"Rest", "@", "#"}], "]"}], "[", 
                 RowBox[{"First", "@", "#"}], "]"}], "]"}], "&"}], "/@", 
              RowBox[{"Permutations", "[", 
               RowBox[{"ToString", "/@", "#"}], "]"}]}], "&"}], ")"}], "[", 
           "z", "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"ToExpression", "@", "#"}], "\[Equal]", "24"}], "&"}]}], 
        "]"}]}], "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4", ",", "5", ",", "7"}], "}"}], "]"}], "//", "TT"}],
    "//", "TableForm"}], "\n"}]], "Input",
 CellChangeTimes->{{3.7227623241261163`*^9, 
  3.7227623856153216`*^9}},ExpressionUUID->"e73a7714-4583-4f7a-a120-\
1ebcd80cda99"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox["\<\"\:603b\:8fd0\:884c\:65f6: \"\>",
   "EchoLabel"], " ", "0.03485823533857527`"}]], "Echo",
 CellChangeTimes->{
  3.722762395565082*^9},ExpressionUUID->"69d7083f-0ae3-45a8-938c-\
4831b5bcdf19"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"CPU \:65f6\:95f4: \"\>",
   "EchoLabel"], " ", "0.03125`"}]], "Echo",
 CellChangeTimes->{
  3.722762395580092*^9},ExpressionUUID->"806ec6c4-5b3a-4571-8ffe-\
bf2445ddbc18"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {"\<\"(((3*4)+5)+7)\"\>"},
     {"\<\"(((3*4)+7)+5)\"\>"},
     {"\<\"(((4*3)+5)+7)\"\>"},
     {"\<\"(((4*3)+7)+5)\"\>"},
     {"\<\"(((4*5)-3)+7)\"\>"},
     {"\<\"(((4*5)+7)-3)\"\>"},
     {"\<\"(((5*4)-3)+7)\"\>"},
     {"\<\"(((5-4)+7)*3)\"\>"},
     {"\<\"(((5*4)+7)-3)\"\>"},
     {"\<\"(((5+7)-4)*3)\"\>"},
     {"\<\"(((7-3)*5)+4)\"\>"},
     {"\<\"(((7-4)+5)*3)\"\>"},
     {"\<\"(((7-5)*3)*4)\"\>"},
     {"\<\"(((7+5)-4)*3)\"\>"},
     {"\<\"(((7-5)*4)*3)\"\>"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.722762385995621*^9, 
  3.72276239560461*^9}},ExpressionUUID->"c08fb4de-6570-47fd-894e-\
d0067ee21353"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["findone", "Section",
 CellChangeTimes->{
  3.722751048052615*^9, {3.7227698153852825`*^9, 
   3.7227698174903994`*^9}},ExpressionUUID->"86481ea6-1b9c-4a4c-9c51-\
c12749f63f9d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Poke24", "[", "nums_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"toExprs", ",", "expand", ",", "next", ",", "exprs"}], "}"}], 
    ",", 
    RowBox[{
     RowBox[{
      RowBox[{"toExprs", "[", 
       RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"\"\<(\>\"", "<>", "#", "<>", "\"\<)\>\""}], "&"}], "/@", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x", "<>", "#", "<>", "y"}], ",", 
            RowBox[{"y", "<>", "#", "<>", "x"}]}], "}"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{
          "\"\<+\>\"", ",", "\"\<-\>\"", ",", "\"\<*\>\"", ",", "\"\</\>\""}],
           "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"expand", "[", "set_", "]"}], ":=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"sub", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Complement", "[", 
                RowBox[{"set", ",", "sub"}], "]"}], ",", "#"}], "]"}], "&"}], 
            "/@", 
            RowBox[{"toExprs", "@@", "sub"}]}]}], "]"}], "/@", 
         RowBox[{"Subsets", "[", 
          RowBox[{"set", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"next", "[", "sets_", "]"}], ":=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"expand", "/@", "sets"}], ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"exprs", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Nest", "[", 
        RowBox[{"next", ",", 
         RowBox[{"{", 
          RowBox[{"ToString", "/@", "nums"}], "}"}], ",", 
         RowBox[{
          RowBox[{"Length", "[", "nums", "]"}], "-", "1"}]}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"DeleteDuplicates", "[", "exprs", "]"}], ",", 
       RowBox[{
        RowBox[{"Quiet", "[", 
         RowBox[{
          RowBox[{"ToExpression", "[", "#", "]"}], "\[Equal]", "24"}], "]"}], 
        "&"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.722750831377653*^9, 
  3.7227508313806562`*^9}},ExpressionUUID->"0db74ea0-5716-4e17-b1fa-\
9ade431a2b2e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Poke24", "[", 
    RowBox[{"{", 
     RowBox[{"3", ",", "7", ",", "6", ",", "1"}], "}"}], "]"}], "//", "TT"}], 
  "//", "TableForm"}]], "Input",
 CellChangeTimes->{3.722750840334982*^9, 
  3.72275733071987*^9},ExpressionUUID->"56bfc059-e223-4c51-97c6-bef307b7f28b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox["\<\"\:603b\:8fd0\:884c\:65f6: \"\>",
   "EchoLabel"], " ", "0.1315910280562188`"}]], "Echo",
 CellChangeTimes->{
  3.7227573313458586`*^9},ExpressionUUID->"15d528e7-0f4c-4afb-8241-\
8d09ae4d3394"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"CPU \:65f6\:95f4: \"\>",
   "EchoLabel"], " ", "0.140625`"}]], "Echo",
 CellChangeTimes->{
  3.7227573313658743`*^9},ExpressionUUID->"233bae0b-7c8f-45bf-bde3-\
21b331c00307"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {"\<\"((7-3)*(1*6))\"\>"},
     {"\<\"((1*6)*(7-3))\"\>"},
     {"\<\"((7-3)*(6*1))\"\>"},
     {"\<\"((6*1)*(7-3))\"\>"},
     {"\<\"((7-3)/(1/6))\"\>"},
     {"\<\"((7-3)*(6/1))\"\>"},
     {"\<\"((6/1)*(7-3))\"\>"},
     {"\<\"(6*(1*(7-3)))\"\>"},
     {"\<\"((1*(7-3))*6)\"\>"},
     {"\<\"(6*((7-3)*1))\"\>"},
     {"\<\"(((7-3)*1)*6)\"\>"},
     {"\<\"(6/(1/(7-3)))\"\>"},
     {"\<\"(6*((7-3)/1))\"\>"},
     {"\<\"(((7-3)/1)*6)\"\>"},
     {"\<\"(1*(6*(7-3)))\"\>"},
     {"\<\"((6*(7-3))*1)\"\>"},
     {"\<\"((6*(7-3))/1)\"\>"},
     {"\<\"(1*((7-3)*6))\"\>"},
     {"\<\"(((7-3)*6)*1)\"\>"},
     {"\<\"(((7-3)*6)/1)\"\>"},
     {"\<\"((6-3)*(1+7))\"\>"},
     {"\<\"((1+7)*(6-3))\"\>"},
     {"\<\"((6-3)*(7+1))\"\>"},
     {"\<\"((7+1)*(6-3))\"\>"},
     {"\<\"((3*6)-(1-7))\"\>"},
     {"\<\"((3*6)+(7-1))\"\>"},
     {"\<\"((7-1)+(3*6))\"\>"},
     {"\<\"(7-(1-(3*6)))\"\>"},
     {"\<\"(7+((3*6)-1))\"\>"},
     {"\<\"(((3*6)-1)+7)\"\>"},
     {"\<\"((7+(3*6))-1)\"\>"},
     {"\<\"(((3*6)+7)-1)\"\>"},
     {"\<\"((6*3)-(1-7))\"\>"},
     {"\<\"((6*3)+(7-1))\"\>"},
     {"\<\"((7-1)+(6*3))\"\>"},
     {"\<\"(7-(1-(6*3)))\"\>"},
     {"\<\"(7+((6*3)-1))\"\>"},
     {"\<\"(((6*3)-1)+7)\"\>"},
     {"\<\"((7+(6*3))-1)\"\>"},
     {"\<\"(((6*3)+7)-1)\"\>"},
     {"\<\"(6*(7-(3*1)))\"\>"},
     {"\<\"((7-(3*1))*6)\"\>"},
     {"\<\"(6*(7-(1*3)))\"\>"},
     {"\<\"((7-(1*3))*6)\"\>"},
     {"\<\"(6*(7-(3/1)))\"\>"},
     {"\<\"((7-(3/1))*6)\"\>"},
     {"\<\"(6+(3*(7-1)))\"\>"},
     {"\<\"((3*(7-1))+6)\"\>"},
     {"\<\"(6+((7-1)*3))\"\>"},
     {"\<\"(((7-1)*3)+6)\"\>"},
     {"\<\"(6-(3*(1-7)))\"\>"},
     {"\<\"(6-((1-7)*3))\"\>"},
     {"\<\"(6*((7*1)-3))\"\>"},
     {"\<\"(((7*1)-3)*6)\"\>"},
     {"\<\"(6*((1*7)-3))\"\>"},
     {"\<\"(((1*7)-3)*6)\"\>"},
     {"\<\"(6*((7/1)-3))\"\>"},
     {"\<\"(((7/1)-3)*6)\"\>"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7227508411250925`*^9, 3.722751045222492*^9, 
  3.7227573313848753`*^9},ExpressionUUID->"7be3ec56-3ed0-4961-a318-\
465430616c17"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cal24", "[", "nums_List", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ops", ",", 
      RowBox[{"num", "=", "nums"}], ",", "rule", ",", "same", ",", "filter"}],
      "}"}], ",", 
    RowBox[{
     RowBox[{"ops", "=", 
      RowBox[{"{", 
       RowBox[{"Plus", ",", "Subtract", ",", "Times", ",", "Divide"}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rule", "=", 
      RowBox[{"Thread", "[", 
       RowBox[{"num", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z", ",", "w"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"same", "[", 
       RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p", ",", "q"}], "}"}], ",", 
        RowBox[{
         RowBox[{"p", "=", 
          RowBox[{"a", "/.", "rule"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"q", "=", 
          RowBox[{"b", "/.", "rule"}]}], ";", 
         RowBox[{
          RowBox[{"ReleaseHold", "[", "p", "]"}], "===", 
          RowBox[{"ReleaseHold", "[", "q", "]"}]}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"filter", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"op1_", ",", "op2_", ",", "op3_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "}"}]}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ans", "=", 
          RowBox[{"{", "}"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Quiet", "@", 
             RowBox[{"op1", "[", 
              RowBox[{
               RowBox[{"op2", "[", 
                RowBox[{
                 RowBox[{"op3", "[", 
                  RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
               "d"}], "]"}]}], "\[Equal]", "24"}], ",", 
           RowBox[{
            RowBox[{"ans", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"ans", ",", 
               RowBox[{"{", 
                RowBox[{"HoldForm", "@", 
                 RowBox[{"op1", "[", 
                  RowBox[{
                   RowBox[{"op2", "[", 
                    RowBox[{
                    RowBox[{"op3", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                   "d"}], "]"}]}], "}"}]}], "]"}]}], ";"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Quiet", "@", 
             RowBox[{"op1", "[", 
              RowBox[{
               RowBox[{"op2", "[", 
                RowBox[{"a", ",", "b"}], "]"}], ",", 
               RowBox[{"op3", "[", 
                RowBox[{"c", ",", "d"}], "]"}]}], "]"}]}], "\[Equal]", "24"}],
            ",", 
           RowBox[{
            RowBox[{"ans", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"ans", ",", 
               RowBox[{"{", 
                RowBox[{"HoldForm", "@", 
                 RowBox[{"op1", "[", 
                  RowBox[{
                   RowBox[{"op2", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", 
                   RowBox[{"op3", "[", 
                    RowBox[{"c", ",", "d"}], "]"}]}], "]"}]}], "}"}]}], 
              "]"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Quiet", "@", 
             RowBox[{"op1", "[", 
              RowBox[{
               RowBox[{"op2", "[", 
                RowBox[{"a", ",", 
                 RowBox[{"op3", "[", 
                  RowBox[{"b", ",", "c"}], "]"}]}], "]"}], ",", "d"}], 
              "]"}]}], "\[Equal]", "24"}], ",", 
           RowBox[{
            RowBox[{"ans", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"ans", ",", 
               RowBox[{"{", 
                RowBox[{"HoldForm", "@", 
                 RowBox[{"op1", "[", 
                  RowBox[{
                   RowBox[{"op2", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{"op3", "[", 
                    RowBox[{"b", ",", "c"}], "]"}]}], "]"}], ",", "d"}], 
                  "]"}]}], "}"}]}], "]"}]}], ";"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Quiet", "@", 
             RowBox[{"op1", "[", 
              RowBox[{"a", ",", 
               RowBox[{"op2", "[", 
                RowBox[{"b", ",", 
                 RowBox[{"op3", "[", 
                  RowBox[{"c", ",", "d"}], "]"}]}], "]"}]}], "]"}]}], 
            "\[Equal]", "24"}], ",", 
           RowBox[{
            RowBox[{"ans", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"ans", ",", 
               RowBox[{"{", 
                RowBox[{"HoldForm", "@", 
                 RowBox[{"op1", "[", 
                  RowBox[{"a", ",", 
                   RowBox[{"op2", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"op3", "[", 
                    RowBox[{"c", ",", "d"}], "]"}]}], "]"}]}], "]"}]}], 
                "}"}]}], "]"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
         "ans"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{
       RowBox[{"Union", "@@", 
        RowBox[{"filter", "@@@", 
         RowBox[{"Tuples", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{"ops", ",", "3"}], "]"}], ",", 
            RowBox[{"Permutations", "[", "num", "]"}]}], "}"}], "]"}]}]}], 
       ",", "same"}], "]"}]}]}], "]"}]}], "\n", 
 RowBox[{"cal24", "[", 
  RowBox[{"{", 
   RowBox[{"2", ",", "3", ",", "5", ",", "7"}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7227509350638514`*^9, 
  3.7227509350668535`*^9}},ExpressionUUID->"64352a7d-117c-4190-ad1f-\
2e92dec5a43a"]
}, Open  ]]
},
WindowSize->{826, 873},
WindowMargins->{{444, Automatic}, {Automatic, 46}},
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (2017\:5e7410\:67082\
\:65e5)",
StyleDefinitions->FrontEnd`FileName[{"Report"}, "StandardReport.nb", 
  CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 133, 3, 68, "Section",ExpressionUUID->"4be31f26-bcb2-4dea-ad26-3cf462e3832a"],
Cell[716, 27, 4578, 128, 219, "Input",ExpressionUUID->"635d6187-735e-4616-a324-13e291f0ae25"],
Cell[CellGroupData[{
Cell[5319, 159, 398, 10, 38, "Input",ExpressionUUID->"7a4c0846-eaca-4287-8908-a3b102a4386f"],
Cell[CellGroupData[{
Cell[5742, 173, 229, 6, 22, "Echo",ExpressionUUID->"bf3bc895-ed80-42e7-a6b6-eed2e8fee2d5"],
Cell[5974, 181, 210, 6, 22, "Echo",ExpressionUUID->"2b280299-044a-45fd-9736-0679d40d5374"]
}, Open  ]],
Cell[6199, 190, 1105, 31, 191, "Output",ExpressionUUID->"2e1736c8-1a51-45fb-96f0-f1a4cfaeeca9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7341, 226, 269, 6, 38, "Input",ExpressionUUID->"b434bd63-a539-4b92-bb71-110ae09d7a50"],
Cell[7613, 234, 1714, 56, 106, "Output",ExpressionUUID->"c7029ffc-5579-461c-9d8c-bb9e583acb2e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9364, 295, 307, 8, 38, "Input",ExpressionUUID->"cfdec555-031a-4b1c-9973-8478f59864b7"],
Cell[9674, 305, 281, 8, 38, "Output",ExpressionUUID->"90b6e39a-0a1d-4b63-84fc-5d164fd87766"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[10004, 319, 129, 3, 54, "Section",ExpressionUUID->"c067f0f7-d57d-4348-9cbe-7da1a813ddf7"],
Cell[10136, 324, 3354, 85, 165, "Input",ExpressionUUID->"9f99713d-ead6-4aba-896f-17708a3f3037"],
Cell[CellGroupData[{
Cell[13515, 413, 376, 10, 38, "Input",ExpressionUUID->"981fdc67-308b-4f39-955f-2d9a0444331e"],
Cell[CellGroupData[{
Cell[13916, 427, 230, 6, 22, "Echo",ExpressionUUID->"b60c0d47-7032-4045-bdf0-345dd07da856"],
Cell[14149, 435, 212, 6, 22, "Echo",ExpressionUUID->"375ecccb-cf19-4ae0-b3ed-c0f86736ef29"]
}, Open  ]],
Cell[14376, 444, 899, 24, 106, "Output",ExpressionUUID->"0869d554-33ed-4a5d-89cc-819348926a22"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[15324, 474, 129, 3, 68, "Section",ExpressionUUID->"76190c84-0ca0-43ba-b8e3-18f0c1ee1e16"],
Cell[15456, 479, 3948, 101, 219, "Input",ExpressionUUID->"4dfb6423-6e32-4659-9884-d2ec997b950c"],
Cell[CellGroupData[{
Cell[19429, 584, 403, 11, 38, "Input",ExpressionUUID->"95e57147-b767-4aea-bf8d-093fe3e1cb2d"],
Cell[CellGroupData[{
Cell[19857, 599, 231, 6, 22, "Echo",ExpressionUUID->"7c81c1a1-b3ce-44ce-81e8-9414c26fdd42"],
Cell[20091, 607, 212, 6, 22, "Echo",ExpressionUUID->"eb431528-6238-49db-9456-4e6bafc061d5"]
}, Open  ]],
Cell[20318, 616, 2741, 68, 883, "Output",ExpressionUUID->"93695cfa-1504-44bf-a842-ab5d43454d70"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[23108, 690, 127, 3, 54, "Section",ExpressionUUID->"5ef90a20-afa1-4cc2-8984-14d76b7d78e3"],
Cell[23238, 695, 2478, 70, 147, "Input",ExpressionUUID->"0db11b42-b469-428d-925a-5c2f9e3f9cf9"],
Cell[CellGroupData[{
Cell[25741, 769, 312, 8, 38, "Input",ExpressionUUID->"1df3b7e9-b5ab-425e-bb13-709c3d1180c7"],
Cell[CellGroupData[{
Cell[26078, 781, 230, 6, 22, "Echo",ExpressionUUID->"da22867b-0b3d-43b8-99f5-8ce947d71577"],
Cell[26311, 789, 212, 6, 22, "Echo",ExpressionUUID->"49c77fa5-94de-4ba3-b687-54e0ecb96385"]
}, Open  ]],
Cell[26538, 798, 2540, 77, 1007, "Output",ExpressionUUID->"a9a26b2b-0932-4bf0-a3c1-e13b1be8ad73"]
}, Open  ]],
Cell[29093, 878, 6086, 164, 298, "Input",ExpressionUUID->"15ad0089-1418-4b70-8c88-e659a3ee5bf7"]
}, Closed]],
Cell[CellGroupData[{
Cell[35216, 1047, 128, 3, 54, "Section",ExpressionUUID->"a0e47a12-79c3-4e9a-9053-bbfe6bae5730"],
Cell[CellGroupData[{
Cell[35369, 1054, 158, 3, 38, "Input",ExpressionUUID->"359ac8a6-b74c-460a-9d1c-44eb64ff13c9"],
Cell[35530, 1059, 246, 6, 22, "Echo",ExpressionUUID->"777057a7-7ceb-4237-ae8a-0a58cfc4a9ff"]
}, Open  ]],
Cell[35791, 1068, 7366, 191, 291, "Input",ExpressionUUID->"89190d68-8c41-4fc8-8c7b-cfb618f7a575"],
Cell[CellGroupData[{
Cell[43182, 1263, 949, 20, 38, "Input",ExpressionUUID->"91822627-1337-4a94-9c1c-a2527b6d771e"],
Cell[CellGroupData[{
Cell[44156, 1287, 230, 6, 22, "Echo",ExpressionUUID->"b6b11927-dda7-4771-aad9-74dd04aff0e0"],
Cell[44389, 1295, 212, 6, 22, "Echo",ExpressionUUID->"0d6a86cd-0c74-4681-b339-b7e5e6dec104"]
}, Open  ]],
Cell[44616, 1304, 2211, 59, 55, "Output",ExpressionUUID->"4e406e45-fc52-468c-88ad-f295ea27b94e"]
}, Open  ]],
Cell[46842, 1366, 595, 19, 57, "Input",ExpressionUUID->"cbd02068-2ec3-45ff-b853-6b8548bafba9"],
Cell[CellGroupData[{
Cell[47462, 1389, 4275, 120, 327, "Input",ExpressionUUID->"36aea2c4-6775-48d1-8fed-b0f3041c5564"],
Cell[51740, 1511, 2366, 64, 106, "Output",ExpressionUUID->"7d0ec301-ac32-4036-9087-6579a21fc81f"],
Cell[54109, 1577, 4272, 124, 111, "Output",ExpressionUUID->"4640ecb6-f6e5-46cb-b773-825b47fb0dba"],
Cell[58384, 1703, 1309, 18, 111, "Output",ExpressionUUID->"e03c474a-dfd3-405d-b9ed-97dd4ad57902"],
Cell[59696, 1723, 891, 13, 57, "Output",ExpressionUUID->"b8e7a60c-bf36-4a3f-a351-129898ccce7f"],
Cell[60590, 1738, 889, 13, 57, "Output",ExpressionUUID->"1cfdd644-9c99-486e-a963-bb7a74084471"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61516, 1756, 132, 3, 38, "Input",ExpressionUUID->"d541cf2e-4bc8-4229-a42f-f4c5294891fe"],
Cell[61651, 1761, 246, 6, 22, "Echo",ExpressionUUID->"6d68ab79-5aee-4eef-b0ad-241c7880f7b5"]
}, Open  ]],
Cell[61912, 1770, 422, 9, 165, "Input",ExpressionUUID->"e2323887-a5d8-4b87-ab59-b82e40f84da8"],
Cell[CellGroupData[{
Cell[62359, 1783, 2355, 61, 165, "Input",ExpressionUUID->"e73a7714-4583-4f7a-a120-1ebcd80cda99"],
Cell[CellGroupData[{
Cell[64739, 1848, 229, 6, 22, "Echo",ExpressionUUID->"69d7083f-0ae3-45a8-938c-4831b5bcdf19"],
Cell[64971, 1856, 209, 6, 22, "Echo",ExpressionUUID->"806ec6c4-5b3a-4571-8ffe-bf2445ddbc18"]
}, Open  ]],
Cell[65195, 1865, 1139, 34, 276, "Output",ExpressionUUID->"c08fb4de-6570-47fd-894e-d0067ee21353"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[66383, 1905, 182, 4, 54, "Section",ExpressionUUID->"86481ea6-1b9c-4a4c-9c51-c12749f63f9d"],
Cell[66568, 1911, 2478, 70, 147, "Input",ExpressionUUID->"0db74ea0-5716-4e17-b1fa-9ade431a2b2e"],
Cell[CellGroupData[{
Cell[69071, 1985, 312, 8, 38, "Input",ExpressionUUID->"56bfc059-e223-4c51-97c6-bef307b7f28b"],
Cell[CellGroupData[{
Cell[69408, 1997, 230, 6, 22, "Echo",ExpressionUUID->"15d528e7-0f4c-4afb-8241-8d09ae4d3394"],
Cell[69641, 2005, 212, 6, 22, "Echo",ExpressionUUID->"233bae0b-7c8f-45bf-bde3-21b331c00307"]
}, Open  ]],
Cell[69868, 2014, 2540, 77, 1007, "Output",ExpressionUUID->"7be3ec56-3ed0-4961-a318-465430616c17"]
}, Open  ]],
Cell[72423, 2094, 6086, 164, 298, "Input",ExpressionUUID->"64352a7d-117c-4190-ad1f-2e92dec5a43a"]
}, Open  ]]
}
]
*)

