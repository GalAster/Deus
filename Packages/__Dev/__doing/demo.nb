(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     68528,       1952]
NotebookOptionsPosition[     63084,       1851]
NotebookOutlinePosition[     63511,       1868]
CellTagsIndexPosition[     63468,       1865]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["game24play", "Section",
 CellChangeTimes->{
  3.7227697180011415`*^9},ExpressionUUID->"4be31f26-bcb2-4dea-ad26-\
3cf462e3832a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"treeR", "[", "n_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"o", "[", 
     RowBox[{
      RowBox[{"treeR", "[", "a", "]"}], ",", 
      RowBox[{"treeR", "[", 
       RowBox[{"n", "-", "a"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "1", ",", 
      RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"treeR", "[", "1", "]"}], ":=", "n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"tree", "[", "n_", "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"treeR", "[", "n", "]"}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"o", "[", 
         RowBox[{"a_List", ",", "b_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"o", "[", 
            RowBox[{"#", ",", "b"}], "]"}], "&"}], "/@", "a"}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"o", "[", 
         RowBox[{"a_", ",", "b_List"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"o", "[", 
            RowBox[{"a", ",", "#"}], "]"}], "&"}], "/@", "b"}], ")"}]}]}], 
      "}"}]}], "]"}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"game24play", "[", "val_List", "]"}], ":=", 
  RowBox[{"Union", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"StringReplace", "[", 
      RowBox[{
       RowBox[{"StringTake", "[", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"#", ",", "InputForm"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"10", ",", 
           RowBox[{"-", "2"}]}], "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"\"\<-1*\>\"", "~~", "n_"}], "\[RuleDelayed]", 
        RowBox[{"\"\<-\>\"", "<>", "n"}]}]}], "]"}], "&"}], "/@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"HoldForm", "/@", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Union", "@", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Outer", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"o", "[", "q_Integer", "]"}], "\[RuleDelayed]", 
                  RowBox[{"#2", "[", 
                   RowBox[{"[", "q", "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"n", "[", "q_", "]"}], "\[RuleDelayed]", 
                  RowBox[{"#3", "[", 
                   RowBox[{"[", "q", "]"}], "]"}]}]}], "}"}]}], "&"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Block", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"O", "=", "1"}], ",", 
                   RowBox[{"N", "=", "1"}]}], "}"}], ",", 
                 RowBox[{"#", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"o", "\[RuleDelayed]", 
                    RowBox[{"o", "[", 
                    RowBox[{"O", "++"}], "]"}]}], ",", 
                    RowBox[{"n", "\[RuleDelayed]", 
                    RowBox[{"n", "[", 
                    RowBox[{"N", "++"}], "]"}]}]}], "}"}]}]}], "]"}], "&"}], "/@", 
              RowBox[{"tree", "[", "4", "]"}]}], ",", 
             RowBox[{"Tuples", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "Plus", ",", "Subtract", ",", "Times", ",", "Divide"}], "}"}],
                ",", "3"}], "]"}], ",", 
             RowBox[{"Permutations", "[", 
              RowBox[{"Array", "[", 
               RowBox[{"v", ",", "4"}], "]"}], "]"}], ",", "1"}], "]"}], 
           "]"}]}], ",", 
         RowBox[{
          RowBox[{"Quiet", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "/.", 
              RowBox[{
               RowBox[{"v", "[", "q_", "]"}], "\[RuleDelayed]", 
               RowBox[{"val", "[", 
                RowBox[{"[", "q", "]"}], "]"}]}]}], ")"}], "\[Equal]", "24"}],
            "]"}], "&"}]}], "]"}]}], "/.", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"v", "[", "q", "]"}], "\[Rule]", 
         RowBox[{"val", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"q", ",", "4"}], "}"}]}], "]"}]}], ")"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.7226506470490503`*^9, 3.722650647916032*^9}, {
  3.7227571930037727`*^9, 
  3.7227572119382477`*^9}},ExpressionUUID->"635d6187-735e-4616-a324-\
13e291f0ae25"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"game24play", "[", 
    RowBox[{"{", 
     RowBox[{"3", ",", "7", ",", "6", ",", "1"}], "}"}], "]"}], "//", "TT"}], 
  "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.722650656327359*^9, 3.722650656375836*^9}, 
   3.7227506885699015`*^9, {3.722757306704685*^9, 
   3.7227573103472414`*^9}},ExpressionUUID->"7a4c0846-eaca-4287-8908-\
a3b102a4386f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox["\<\"\:603b\:8fd0\:884c\:65f6: \"\>",
   "EchoLabel"], " ", "0.16136081385334702`"}]], "Echo",
 CellChangeTimes->{
  3.722757311155553*^9},ExpressionUUID->"bf3bc895-ed80-42e7-a6b6-\
eed2e8fee2d5"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"CPU \:65f6\:95f4: \"\>",
   "EchoLabel"], " ", "0.171875`"}]], "Echo",
 CellChangeTimes->{
  3.722757311177215*^9},ExpressionUUID->"2b280299-044a-45fd-9736-\
0679d40d5374"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {"\<\"(-3 + 6)*(7 + 1)\"\>"},
     {"\<\"((-3 + 7)*6)/1\"\>"},
     {"\<\"(-3 + 7)*6*1\"\>"},
     {"\<\"6 - 3*(-7 + 1)\"\>"},
     {"\<\"6*(-3 + 7*1)\"\>"},
     {"\<\"6*(-3 + 7/1)\"\>"},
     {"\<\"6 + 3*(7 - 1)\"\>"},
     {"\<\"6*(7 - 3*1)\"\>"},
     {"\<\"6*(7 - 3/1)\"\>"},
     {"\<\"7 + 3*6 - 1\"\>"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7226506568704247`*^9, 3.722650665858526*^9}, {
   3.722750689616638*^9, 3.7227506934841337`*^9}, 3.7227570973503256`*^9, 
   3.722757246186157*^9, 
   3.7227573111983213`*^9},ExpressionUUID->"2e1736c8-1a51-45fb-96f0-\
f1a4cfaeeca9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"tree", "[", "4", "]"}], "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.72275716708805*^9, 3.7227571683887005`*^9}, {
  3.7227572011668825`*^9, 
  3.7227572323308887`*^9}},ExpressionUUID->"b434bd63-a539-4b92-bb71-\
110ae09d7a50"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{"o", "[", 
       RowBox[{"n", ",", 
        RowBox[{"o", "[", 
         RowBox[{"n", ",", 
          RowBox[{"o", "[", 
           RowBox[{"n", ",", "n"}], "]"}]}], "]"}]}], "]"}]},
     {
      RowBox[{"o", "[", 
       RowBox[{"n", ",", 
        RowBox[{"o", "[", 
         RowBox[{
          RowBox[{"o", "[", 
           RowBox[{"n", ",", "n"}], "]"}], ",", "n"}], "]"}]}], "]"}]},
     {
      RowBox[{"o", "[", 
       RowBox[{
        RowBox[{"o", "[", 
         RowBox[{"n", ",", "n"}], "]"}], ",", 
        RowBox[{"o", "[", 
         RowBox[{"n", ",", "n"}], "]"}]}], "]"}]},
     {
      RowBox[{"o", "[", 
       RowBox[{
        RowBox[{"o", "[", 
         RowBox[{"n", ",", 
          RowBox[{"o", "[", 
           RowBox[{"n", ",", "n"}], "]"}]}], "]"}], ",", "n"}], "]"}]},
     {
      RowBox[{"o", "[", 
       RowBox[{
        RowBox[{"o", "[", 
         RowBox[{
          RowBox[{"o", "[", 
           RowBox[{"n", ",", "n"}], "]"}], ",", "n"}], "]"}], ",", "n"}], 
       "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7227571687072415`*^9, {3.7227571994100375`*^9, 
   3.722757232737215*^9}},ExpressionUUID->"c7029ffc-5579-461c-9d8c-\
bb9e583acb2e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Hyperlink", "[", 
  RowBox[{
  "Poker24", ",", 
   "\"\<https://rosettacode.org/wiki/24_game/Solve#Mathematica_.2F_Wolfram_\
Language\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.722650677686729*^9, 
  3.72265070205757*^9}},ExpressionUUID->"cfdec555-031a-4b1c-9973-\
8478f59864b7"],

Cell[BoxData[
 TemplateBox[{
  "Poker24",
   "https://rosettacode.org/wiki/24_game/Solve#Mathematica_.2F_Wolfram_\
Language"},
  "HyperlinkURL"]], "Output",
 CellChangeTimes->{{3.722650678925707*^9, 
  3.72265070242763*^9}},ExpressionUUID->"90b6e39a-0a1d-4b63-84fc-\
5d164fd87766"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["cal24", "Section",
 CellChangeTimes->{
  3.7227697545731583`*^9},ExpressionUUID->"a0e47a12-79c3-4e9a-9053-\
bbfe6bae5730"],

Cell[CellGroupData[{

Cell[BoxData["Quit"], "Input",
 CellChangeTimes->{{3.722762545800881*^9, 
  3.7227625716375256`*^9}},ExpressionUUID->"359ac8a6-b74c-460a-9d1c-\
44eb64ff13c9"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"\:6240\:6709\:4e34\:65f6\:5b9a\:4e49\:5df2\:6e05\:7a7a!\"\>",
   "EchoLabel"], " ", "\<\"\"\>"}]], "Echo",
 CellChangeTimes->{
  3.722762546491535*^9},ExpressionUUID->"777057a7-7ceb-4237-ae8a-\
0a58cfc4a9ff"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"cal24", "[", "nums_List", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ops", ",", 
      RowBox[{"num", "=", "nums"}], ",", "rule", ",", "same", ",", "filter"}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ops", "=", 
      RowBox[{"{", 
       RowBox[{"Plus", ",", "Subtract", ",", "Times", ",", "Divide"}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rule", "=", 
      RowBox[{"Thread", "[", 
       RowBox[{"num", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z", ",", "w"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"same", "[", 
       RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p", ",", "q"}], "}"}], ",", 
        RowBox[{
         RowBox[{"p", "=", 
          RowBox[{"a", "/.", "rule"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"q", "=", 
          RowBox[{"b", "/.", "rule"}]}], ";", 
         RowBox[{
          RowBox[{"ReleaseHold", "[", "p", "]"}], "===", 
          RowBox[{"ReleaseHold", "[", "q", "]"}]}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"filter", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"op1_", ",", "op2_", ",", "op3_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "}"}]}], "]"}], ":=", 
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ans", "=", 
          RowBox[{"{", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Quiet", "@", 
             RowBox[{"op1", "[", 
              RowBox[{
               RowBox[{"op2", "[", 
                RowBox[{
                 RowBox[{"op3", "[", 
                  RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
               "d"}], "]"}]}], "\[Equal]", "24"}], ",", 
           RowBox[{
            RowBox[{"ans", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"ans", ",", 
               RowBox[{"{", 
                RowBox[{"HoldForm", "@", 
                 RowBox[{"op1", "[", 
                  RowBox[{
                   RowBox[{"op2", "[", 
                    RowBox[{
                    RowBox[{"op3", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                   "d"}], "]"}]}], "}"}]}], "]"}]}], ";"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Quiet", "@", 
             RowBox[{"op1", "[", 
              RowBox[{
               RowBox[{"op2", "[", 
                RowBox[{"a", ",", "b"}], "]"}], ",", 
               RowBox[{"op3", "[", 
                RowBox[{"c", ",", "d"}], "]"}]}], "]"}]}], "\[Equal]", "24"}],
            ",", 
           RowBox[{
            RowBox[{"ans", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"ans", ",", 
               RowBox[{"{", 
                RowBox[{"HoldForm", "@", 
                 RowBox[{"op1", "[", 
                  RowBox[{
                   RowBox[{"op2", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", 
                   RowBox[{"op3", "[", 
                    RowBox[{"c", ",", "d"}], "]"}]}], "]"}]}], "}"}]}], 
              "]"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Quiet", "@", 
             RowBox[{"op1", "[", 
              RowBox[{
               RowBox[{"op2", "[", 
                RowBox[{"a", ",", 
                 RowBox[{"op3", "[", 
                  RowBox[{"b", ",", "c"}], "]"}]}], "]"}], ",", "d"}], 
              "]"}]}], "\[Equal]", "24"}], ",", 
           RowBox[{
            RowBox[{"ans", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"ans", ",", 
               RowBox[{"{", 
                RowBox[{"HoldForm", "@", 
                 RowBox[{"op1", "[", 
                  RowBox[{
                   RowBox[{"op2", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{"op3", "[", 
                    RowBox[{"b", ",", "c"}], "]"}]}], "]"}], ",", "d"}], 
                  "]"}]}], "}"}]}], "]"}]}], ";"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Quiet", "@", 
             RowBox[{"op1", "[", 
              RowBox[{"a", ",", 
               RowBox[{"op2", "[", 
                RowBox[{
                 RowBox[{"op3", "[", 
                  RowBox[{"b", ",", "c"}], "]"}], ",", "d"}], "]"}]}], 
              "]"}]}], "\[Equal]", "24"}], ",", 
           RowBox[{
            RowBox[{"ans", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"ans", ",", 
               RowBox[{"{", 
                RowBox[{"HoldForm", "@", 
                 RowBox[{"op1", "[", 
                  RowBox[{"a", ",", 
                   RowBox[{"op2", "[", 
                    RowBox[{
                    RowBox[{"op3", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], ",", "d"}], "]"}]}], 
                  "]"}]}], "}"}]}], "]"}]}], ";"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Quiet", "@", 
             RowBox[{"op1", "[", 
              RowBox[{"a", ",", 
               RowBox[{"op2", "[", 
                RowBox[{"b", ",", 
                 RowBox[{"op3", "[", 
                  RowBox[{"c", ",", "d"}], "]"}]}], "]"}]}], "]"}]}], 
            "\[Equal]", "24"}], ",", 
           RowBox[{
            RowBox[{"ans", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"ans", ",", 
               RowBox[{"{", 
                RowBox[{"HoldForm", "@", 
                 RowBox[{"op1", "[", 
                  RowBox[{"a", ",", 
                   RowBox[{"op2", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"op3", "[", 
                    RowBox[{"c", ",", "d"}], "]"}]}], "]"}]}], "]"}]}], 
                "}"}]}], "]"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
         "ans"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{
       RowBox[{"Union", "@@", 
        RowBox[{"filter", "@@@", 
         RowBox[{"Tuples", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{"ops", ",", "3"}], "]"}], ",", 
            RowBox[{"Permutations", "[", "num", "]"}]}], "}"}], "]"}]}]}], 
       ",", "same"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.722750629896695*^9, 3.7227506384618597`*^9}, {
  3.7227510659777145`*^9, 3.7227510692111444`*^9}, {3.7227511751246977`*^9, 
  3.7227511755431175`*^9}, {3.722757880814502*^9, 3.7227578836941833`*^9}, {
  3.722761655897828*^9, 3.7227617217541084`*^9}, {3.7227617810932283`*^9, 
  3.7227617821893387`*^9}, {3.722762172298827*^9, 3.7227622060830765`*^9}, {
  3.7227628797159195`*^9, 
  3.722762922393431*^9}},ExpressionUUID->"89190d68-8c41-4fc8-8c7b-\
cfb618f7a575"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cal24", "[", 
     RowBox[{"{", 
      RowBox[{"3", ",", "5", ",", "7", ",", "1"}], "}"}], "]"}], "/.", 
    RowBox[{
     RowBox[{"HoldForm", "[", "x__", "]"}], "\[RuleDelayed]", 
     RowBox[{"HoldForm", "[", 
      RowBox[{"InputForm", "[", "x", "]"}], "]"}]}]}], "//", "TableForm"}], "//",
   "TT"}]], "Input",
 CellChangeTimes->{{3.722750642022914*^9, 3.7227506644127803`*^9}, 
   3.722751072486038*^9, 3.722757337824506*^9, 3.722761637423958*^9, 
   3.722761674896062*^9, {3.722761827036135*^9, 3.7227618300565042`*^9}, {
   3.722762465586049*^9, 3.7227624694412336`*^9}, 3.722762532777153*^9, {
   3.7227625854358835`*^9, 3.722762615619322*^9}, {3.722762766895601*^9, 
   3.7227627752516017`*^9}, 3.7227628530623755`*^9, {3.722762939924328*^9, 
   3.7227629660473676`*^9}, {3.722763007947606*^9, 
   3.7227630240280538`*^9}},ExpressionUUID->"91822627-1337-4a94-9c1c-\
a2527b6d771e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox["\<\"\:603b\:8fd0\:884c\:65f6: \"\>",
   "EchoLabel"], " ", "0.0405615722455332`"}]], "Echo",
 CellChangeTimes->{
  3.7227630245159006`*^9},ExpressionUUID->"b6b11927-dda7-4771-aad9-\
74dd04aff0e0"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"CPU \:65f6\:95f4: \"\>",
   "EchoLabel"], " ", "0.046875`"}]], "Echo",
 CellChangeTimes->{
  3.7227630245283966`*^9},ExpressionUUID->"0d6a86cd-0c74-4681-b339-\
b7e5e6dec104"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      TagBox[
       InterpretationBox[
        StyleBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{"7", " ", "-", " ", "3"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"5", " ", "+", " ", "1"}], ")"}]}],
         ShowStringCharacters->True,
         NumberMarks->True],
        InputForm[Subtract[7, 3] (5 + 1)],
        AutoDelete->True,
        Editable->True],
       HoldForm]},
     {
      TagBox[
       InterpretationBox[
        StyleBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{"3", " ", "-", " ", "1"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"7", " ", "+", " ", "5"}], ")"}]}],
         ShowStringCharacters->True,
         NumberMarks->True],
        InputForm[Subtract[3, 1] (7 + 5)],
        AutoDelete->True,
        Editable->True],
       HoldForm]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.722750644619388*^9, 3.722750664938198*^9}, 
   3.7227510735825925`*^9, 3.722751126411598*^9, 3.7227511790365047`*^9, 
   3.7227570889415708`*^9, 3.7227573384850817`*^9, {3.7227616236334476`*^9, 
   3.7227616249270544`*^9}, {3.7227616730375752`*^9, 
   3.7227616763226967`*^9}, {3.722761777126526*^9, 3.72276178474741*^9}, 
   3.72276183068469*^9, {3.722762199092066*^9, 3.7227622079499483`*^9}, {
   3.722762460811884*^9, 3.7227624826700077`*^9}, {3.722762534046262*^9, 
   3.7227625488223467`*^9}, {3.722762579643652*^9, 3.722762620659236*^9}, {
   3.7227627716754613`*^9, 3.722762775729761*^9}, {3.72276285362481*^9, 
   3.7227628571775274`*^9}, {3.7227629024026184`*^9, 3.72276296652411*^9}, {
   3.722763009661214*^9, 
   3.722763024547926*^9}},ExpressionUUID->"4e406e45-fc52-468c-88ad-\
f295ea27b94e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"op1", "[", 
    RowBox[{
     RowBox[{"op2", "[", 
      RowBox[{
       RowBox[{"op3", "[", 
        RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", "d"}], "]"}], 
   "\[Equal]", "24"}], ",", "\[IndentingNewLine]", 
  RowBox[{"op1", "[", 
   RowBox[{
    RowBox[{"op2", "[", 
     RowBox[{
      RowBox[{"op3", "[", 
       RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", "d"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7227573709807606`*^9, 
  3.7227573790036726`*^9}},ExpressionUUID->"cbd02068-2ec3-45ff-b853-\
6b8548bafba9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"treeR", "[", "1", "]"}], "=", "n"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"treeR", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"treeR", "[", "n", "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"o", "[", 
      RowBox[{
       RowBox[{"treeR", "[", "a", "]"}], ",", 
       RowBox[{"treeR", "[", 
        RowBox[{"n", "-", "a"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "1", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"tree", "[", "n_", "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"treeR", "[", "n", "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"o", "[", 
        RowBox[{"a_List", ",", "b_"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"o", "[", 
           RowBox[{"#", ",", "b"}], "]"}], "&"}], "/@", "a"}], ")"}]}], ",", 
      RowBox[{
       RowBox[{"o", "[", 
        RowBox[{"a_", ",", "b_List"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"o", "[", 
           RowBox[{"a", ",", "#"}], "]"}], "&"}], "/@", "b"}], ")"}]}]}], 
     "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tree", "[", "4", "]"}], "//", "TableForm"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nn", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ToExpression", "[", 
       RowBox[{"\"\<n\>\"", "<>", 
        RowBox[{"ToString", "@", "#"}]}], "]"}], "&"}], ",", "4"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"oo", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ToExpression", "[", 
       RowBox[{"\"\<o\>\"", "<>", 
        RowBox[{"ToString", "@", "#"}]}], "]"}], "&"}], ",", 
     RowBox[{"4", "-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ff", "=", 
    RowBox[{
     RowBox[{"ReplacePart", "[", 
      RowBox[{"#", ",", 
       RowBox[{
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"#", ",", "n"}], "]"}], "\[Rule]", "nn"}], "]"}], "~", 
        "Join", "~", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"#", ",", "o"}], "]"}], "\[Rule]", "oo"}], "]"}]}]}], 
      "]"}], "&"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fs", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Quiet", "@", "#"}], "\[Equal]", "24"}], ",", 
       RowBox[{
        RowBox[{"ans", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"ans", ",", 
           RowBox[{"{", 
            RowBox[{"HoldForm", "@", "#"}], "}"}]}], "]"}]}], ";"}]}], "]"}], 
     "&"}], "/@", 
    RowBox[{"(", 
     RowBox[{"ff", "/@", 
      RowBox[{"tree", "[", "4", "]"}]}], ")"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StringReplace", "[", 
   RowBox[{
    RowBox[{"ToString", "@", "fs"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<; ],\>\"", "->", "\"\<; ];\\n\>\""}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"\"\<{\>\"", "\[Rule]", 
  "\"\<{ans={}},\\n\>\""}], "\[IndentingNewLine]", 
 RowBox[{"\"\<}\>\"", "\[Rule]", "\"\<\\n ans}\>\""}]}], "Input",
 CellChangeTimes->{{3.722757454801773*^9, 3.7227574626143537`*^9}, {
   3.72275766660441*^9, 3.7227577305293627`*^9}, {3.7227586860614567`*^9, 
   3.722758716645887*^9}, {3.7227606482658224`*^9, 3.722760648626194*^9}, {
   3.7227606873415136`*^9, 3.7227607165416284`*^9}, 3.7227607732088814`*^9, {
   3.722760815811741*^9, 3.722760816849637*^9}, {3.7227610536701927`*^9, 
   3.722761056448586*^9}, {3.722761154077674*^9, 3.7227611972598495`*^9}, {
   3.7227612419551373`*^9, 3.7227613068011937`*^9}, {3.722761417134508*^9, 
   3.7227614175213394`*^9}, 3.7227622141676216`*^9, {3.7227626762208714`*^9, 
   3.7227626773153286`*^9}, {3.7227676827711897`*^9, 
   3.7227679265632477`*^9}},ExpressionUUID->"36aea2c4-6775-48d1-8fed-\
b0f3041c5564"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{"o", "[", 
       RowBox[{"n", ",", 
        RowBox[{"o", "[", 
         RowBox[{"n", ",", 
          RowBox[{"o", "[", 
           RowBox[{"n", ",", "n"}], "]"}]}], "]"}]}], "]"}]},
     {
      RowBox[{"o", "[", 
       RowBox[{"n", ",", 
        RowBox[{"o", "[", 
         RowBox[{
          RowBox[{"o", "[", 
           RowBox[{"n", ",", "n"}], "]"}], ",", "n"}], "]"}]}], "]"}]},
     {
      RowBox[{"o", "[", 
       RowBox[{
        RowBox[{"o", "[", 
         RowBox[{"n", ",", "n"}], "]"}], ",", 
        RowBox[{"o", "[", 
         RowBox[{"n", ",", "n"}], "]"}]}], "]"}]},
     {
      RowBox[{"o", "[", 
       RowBox[{
        RowBox[{"o", "[", 
         RowBox[{"n", ",", 
          RowBox[{"o", "[", 
           RowBox[{"n", ",", "n"}], "]"}]}], "]"}], ",", "n"}], "]"}]},
     {
      RowBox[{"o", "[", 
       RowBox[{
        RowBox[{"o", "[", 
         RowBox[{
          RowBox[{"o", "[", 
           RowBox[{"n", ",", "n"}], "]"}], ",", "n"}], "]"}], ",", "n"}], 
       "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.722757458192565*^9, 3.7227574628326936`*^9}, {
   3.7227576772732844`*^9, 3.722757730782072*^9}, {3.722758673444269*^9, 
   3.7227587178219275`*^9}, {3.7227606488700943`*^9, 3.722760658160364*^9}, {
   3.7227606881620417`*^9, 3.7227607182662306`*^9}, {3.7227607578834634`*^9, 
   3.722760773573807*^9}, 3.7227608170888605`*^9, 3.722761125269224*^9, {
   3.7227611815022144`*^9, 3.7227611992948303`*^9}, {3.722761242885271*^9, 
   3.722761312052364*^9}, 3.72276141823514*^9, {3.7227622113101563`*^9, 
   3.7227622146047974`*^9}, {3.722767680201835*^9, 3.722767685977903*^9}, {
   3.7227677321095066`*^9, 3.722767777533145*^9}, {3.722767824288247*^9, 
   3.7227678735394707`*^9}, {3.722767921840625*^9, 
   3.722767927360975*^9}},ExpressionUUID->"7d0ec301-ac32-4036-9087-\
6579a21fc81f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"o1", "[", 
       RowBox[{"n1", ",", 
        RowBox[{"o2", "[", 
         RowBox[{"n2", ",", 
          RowBox[{"o3", "[", 
           RowBox[{"n3", ",", "n4"}], "]"}]}], "]"}]}], "]"}], "\[Equal]", 
      "24"}], ",", 
     RowBox[{
      RowBox[{"ans", "=", 
       RowBox[{"ans", "\[Union]", 
        RowBox[{"{", 
         TagBox[
          RowBox[{"o1", "[", 
           RowBox[{"n1", ",", 
            RowBox[{"o2", "[", 
             RowBox[{"n2", ",", 
              RowBox[{"o3", "[", 
               RowBox[{"n3", ",", "n4"}], "]"}]}], "]"}]}], "]"}],
          HoldForm], "}"}]}]}], ";"}]}], "]"}], ",", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"o1", "[", 
       RowBox[{"n1", ",", 
        RowBox[{"o2", "[", 
         RowBox[{
          RowBox[{"o3", "[", 
           RowBox[{"n2", ",", "n3"}], "]"}], ",", "n4"}], "]"}]}], "]"}], 
      "\[Equal]", "24"}], ",", 
     RowBox[{
      RowBox[{"ans", "=", 
       RowBox[{"ans", "\[Union]", 
        RowBox[{"{", 
         TagBox[
          RowBox[{"o1", "[", 
           RowBox[{"n1", ",", 
            RowBox[{"o2", "[", 
             RowBox[{
              RowBox[{"o3", "[", 
               RowBox[{"n2", ",", "n3"}], "]"}], ",", "n4"}], "]"}]}], "]"}],
          HoldForm], "}"}]}]}], ";"}]}], "]"}], ",", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"o1", "[", 
       RowBox[{
        RowBox[{"o2", "[", 
         RowBox[{"n1", ",", "n2"}], "]"}], ",", 
        RowBox[{"o3", "[", 
         RowBox[{"n3", ",", "n4"}], "]"}]}], "]"}], "\[Equal]", "24"}], ",", 
     RowBox[{
      RowBox[{"ans", "=", 
       RowBox[{"ans", "\[Union]", 
        RowBox[{"{", 
         TagBox[
          RowBox[{"o1", "[", 
           RowBox[{
            RowBox[{"o2", "[", 
             RowBox[{"n1", ",", "n2"}], "]"}], ",", 
            RowBox[{"o3", "[", 
             RowBox[{"n3", ",", "n4"}], "]"}]}], "]"}],
          HoldForm], "}"}]}]}], ";"}]}], "]"}], ",", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"o1", "[", 
       RowBox[{
        RowBox[{"o2", "[", 
         RowBox[{"n1", ",", 
          RowBox[{"o3", "[", 
           RowBox[{"n2", ",", "n3"}], "]"}]}], "]"}], ",", "n4"}], "]"}], 
      "\[Equal]", "24"}], ",", 
     RowBox[{
      RowBox[{"ans", "=", 
       RowBox[{"ans", "\[Union]", 
        RowBox[{"{", 
         TagBox[
          RowBox[{"o1", "[", 
           RowBox[{
            RowBox[{"o2", "[", 
             RowBox[{"n1", ",", 
              RowBox[{"o3", "[", 
               RowBox[{"n2", ",", "n3"}], "]"}]}], "]"}], ",", "n4"}], "]"}],
          HoldForm], "}"}]}]}], ";"}]}], "]"}], ",", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"o1", "[", 
       RowBox[{
        RowBox[{"o2", "[", 
         RowBox[{
          RowBox[{"o3", "[", 
           RowBox[{"n1", ",", "n2"}], "]"}], ",", "n3"}], "]"}], ",", "n4"}], 
       "]"}], "\[Equal]", "24"}], ",", 
     RowBox[{
      RowBox[{"ans", "=", 
       RowBox[{"ans", "\[Union]", 
        RowBox[{"{", 
         TagBox[
          RowBox[{"o1", "[", 
           RowBox[{
            RowBox[{"o2", "[", 
             RowBox[{
              RowBox[{"o3", "[", 
               RowBox[{"n1", ",", "n2"}], "]"}], ",", "n3"}], "]"}], ",", 
            "n4"}], "]"}],
          HoldForm], "}"}]}]}], ";"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.722757458192565*^9, 3.7227574628326936`*^9}, {
   3.7227576772732844`*^9, 3.722757730782072*^9}, {3.722758673444269*^9, 
   3.7227587178219275`*^9}, {3.7227606488700943`*^9, 3.722760658160364*^9}, {
   3.7227606881620417`*^9, 3.7227607182662306`*^9}, {3.7227607578834634`*^9, 
   3.722760773573807*^9}, 3.7227608170888605`*^9, 3.722761125269224*^9, {
   3.7227611815022144`*^9, 3.7227611992948303`*^9}, {3.722761242885271*^9, 
   3.722761312052364*^9}, 3.72276141823514*^9, {3.7227622113101563`*^9, 
   3.7227622146047974`*^9}, {3.722767680201835*^9, 3.722767685977903*^9}, {
   3.7227677321095066`*^9, 3.722767777533145*^9}, {3.722767824288247*^9, 
   3.7227678735394707`*^9}, {3.722767921840625*^9, 
   3.7227679273674784`*^9}},ExpressionUUID->"4640ecb6-f6e5-46cb-b773-\
825b47fb0dba"],

Cell[BoxData["\<\"{If[o1[n1, o2[n2, o3[n3, n4]]] == 24, ans = Union[ans, \
{o1[n1, o2[n2, o3[n3, n4]]]}]; ];\\n If[o1[n1, o2[o3[n2, n3], n4]] == 24, ans \
= Union[ans, {o1[n1, o2[o3[n2, n3], n4]]}]; ];\\n If[o1[o2[n1, n2], o3[n3, \
n4]] == 24, ans = Union[ans, {o1[o2[n1, n2], o3[n3, n4]]}]; ];\\n \
If[o1[o2[n1, o3[n2, n3]], n4] == 24, ans = Union[ans, {o1[o2[n1, o3[n2, n3]], \
n4]}]; ];\\n If[o1[o2[o3[n1, n2], n3], n4] == 24, ans = Union[ans, \
{o1[o2[o3[n1, n2], n3], n4]}]; ]}\"\>"], "Output",
 CellChangeTimes->{{3.722757458192565*^9, 3.7227574628326936`*^9}, {
   3.7227576772732844`*^9, 3.722757730782072*^9}, {3.722758673444269*^9, 
   3.7227587178219275`*^9}, {3.7227606488700943`*^9, 3.722760658160364*^9}, {
   3.7227606881620417`*^9, 3.7227607182662306`*^9}, {3.7227607578834634`*^9, 
   3.722760773573807*^9}, 3.7227608170888605`*^9, 3.722761125269224*^9, {
   3.7227611815022144`*^9, 3.7227611992948303`*^9}, {3.722761242885271*^9, 
   3.722761312052364*^9}, 3.72276141823514*^9, {3.7227622113101563`*^9, 
   3.7227622146047974`*^9}, {3.722767680201835*^9, 3.722767685977903*^9}, {
   3.7227677321095066`*^9, 3.722767777533145*^9}, {3.722767824288247*^9, 
   3.7227678735394707`*^9}, {3.722767921840625*^9, 
   3.7227679273724823`*^9}},ExpressionUUID->"e03c474a-dfd3-405d-b9ed-\
97dd4ad57902"],

Cell[BoxData[
 RowBox[{"\<\"{\"\>", "\[Rule]", "\<\"{ans={}},\\n\"\>"}]], "Output",
 CellChangeTimes->{{3.722757458192565*^9, 3.7227574628326936`*^9}, {
   3.7227576772732844`*^9, 3.722757730782072*^9}, {3.722758673444269*^9, 
   3.7227587178219275`*^9}, {3.7227606488700943`*^9, 3.722760658160364*^9}, {
   3.7227606881620417`*^9, 3.7227607182662306`*^9}, {3.7227607578834634`*^9, 
   3.722760773573807*^9}, 3.7227608170888605`*^9, 3.722761125269224*^9, {
   3.7227611815022144`*^9, 3.7227611992948303`*^9}, {3.722761242885271*^9, 
   3.722761312052364*^9}, 3.72276141823514*^9, {3.7227622113101563`*^9, 
   3.7227622146047974`*^9}, {3.722767680201835*^9, 3.722767685977903*^9}, {
   3.7227677321095066`*^9, 3.722767777533145*^9}, {3.722767824288247*^9, 
   3.7227678735394707`*^9}, {3.722767921840625*^9, 
   3.722767927375984*^9}},ExpressionUUID->"b8e7a60c-bf36-4a3f-a351-\
129898ccce7f"],

Cell[BoxData[
 RowBox[{"\<\"}\"\>", "\[Rule]", "\<\"\\n ans}\"\>"}]], "Output",
 CellChangeTimes->{{3.722757458192565*^9, 3.7227574628326936`*^9}, {
   3.7227576772732844`*^9, 3.722757730782072*^9}, {3.722758673444269*^9, 
   3.7227587178219275`*^9}, {3.7227606488700943`*^9, 3.722760658160364*^9}, {
   3.7227606881620417`*^9, 3.7227607182662306`*^9}, {3.7227607578834634`*^9, 
   3.722760773573807*^9}, 3.7227608170888605`*^9, 3.722761125269224*^9, {
   3.7227611815022144`*^9, 3.7227611992948303`*^9}, {3.722761242885271*^9, 
   3.722761312052364*^9}, 3.72276141823514*^9, {3.7227622113101563`*^9, 
   3.7227622146047974`*^9}, {3.722767680201835*^9, 3.722767685977903*^9}, {
   3.7227677321095066`*^9, 3.722767777533145*^9}, {3.722767824288247*^9, 
   3.7227678735394707`*^9}, {3.722767921840625*^9, 
   3.7227679273789873`*^9}},ExpressionUUID->"1cfdd644-9c99-486e-a963-\
bb7a74084471"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["CC"], "Input",
 CellChangeTimes->{
  3.7227587067791615`*^9},ExpressionUUID->"d541cf2e-4bc8-4229-a42f-\
f4c5294891fe"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"\:6240\:6709\:4e34\:65f6\:5b9a\:4e49\:5df2\:6e05\:7a7a!\"\>",
   "EchoLabel"], " ", "\<\"\"\>"}]], "Echo",
 CellChangeTimes->{
  3.722758707158899*^9},ExpressionUUID->"6d68ab79-5aee-4eef-b0ad-\
241c7880f7b5"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"metaFilter", "[", "n_Integer", "]"}], ":=", 
  RowBox[{
  "Block", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.722757830186322*^9, 
  3.7227579024849296`*^9}},ExpressionUUID->"e2323887-a5d8-4b87-ab59-\
b82e40f84da8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Function", "[", 
      RowBox[{"z", ",", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Flatten", "@", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Through", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"Fold", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "\"\<(\>\"", "<>", "#1", "<>", "#2", "<>", "\"\<)\>\""}], 
                    "&"}], ",", "x", ",", "#"}], "]"}]}], "]"}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{"x1", ",", 
                    RowBox[{"Inner", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#1", "<>", "#2"}], "&"}], ",", "x1", ",", "y", 
                    ",", "List"}], "]"}]}], "]"}], "/@", 
                    RowBox[{"Tuples", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<+\>\"", ",", "\"\<-\>\"", ",", "\"\<*\>\"", ",", 
                    "\"\</\>\""}], "}"}], ",", "3"}], "]"}]}]}], "]"}], "[", 
                    "#", "]"}]}], "&"}], "[", 
                  RowBox[{"Rest", "@", "#"}], "]"}], "[", 
                 RowBox[{"First", "@", "#"}], "]"}], "]"}], "&"}], "/@", 
              RowBox[{"Permutations", "[", 
               RowBox[{"ToString", "/@", "#"}], "]"}]}], "&"}], ")"}], "[", 
           "z", "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"ToExpression", "@", "#"}], "\[Equal]", "24"}], "&"}]}], 
        "]"}]}], "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4", ",", "5", ",", "7"}], "}"}], "]"}], "//", "TT"}],
    "//", "TableForm"}], "\n"}]], "Input",
 CellChangeTimes->{{3.7227623241261163`*^9, 
  3.7227623856153216`*^9}},ExpressionUUID->"e73a7714-4583-4f7a-a120-\
1ebcd80cda99"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox["\<\"\:603b\:8fd0\:884c\:65f6: \"\>",
   "EchoLabel"], " ", "0.03485823533857527`"}]], "Echo",
 CellChangeTimes->{
  3.722762395565082*^9},ExpressionUUID->"69d7083f-0ae3-45a8-938c-\
4831b5bcdf19"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"CPU \:65f6\:95f4: \"\>",
   "EchoLabel"], " ", "0.03125`"}]], "Echo",
 CellChangeTimes->{
  3.722762395580092*^9},ExpressionUUID->"806ec6c4-5b3a-4571-8ffe-\
bf2445ddbc18"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {"\<\"(((3*4)+5)+7)\"\>"},
     {"\<\"(((3*4)+7)+5)\"\>"},
     {"\<\"(((4*3)+5)+7)\"\>"},
     {"\<\"(((4*3)+7)+5)\"\>"},
     {"\<\"(((4*5)-3)+7)\"\>"},
     {"\<\"(((4*5)+7)-3)\"\>"},
     {"\<\"(((5*4)-3)+7)\"\>"},
     {"\<\"(((5-4)+7)*3)\"\>"},
     {"\<\"(((5*4)+7)-3)\"\>"},
     {"\<\"(((5+7)-4)*3)\"\>"},
     {"\<\"(((7-3)*5)+4)\"\>"},
     {"\<\"(((7-4)+5)*3)\"\>"},
     {"\<\"(((7-5)*3)*4)\"\>"},
     {"\<\"(((7+5)-4)*3)\"\>"},
     {"\<\"(((7-5)*4)*3)\"\>"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.722762385995621*^9, 
  3.72276239560461*^9}},ExpressionUUID->"c08fb4de-6570-47fd-894e-\
d0067ee21353"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["findone", "Section",
 CellChangeTimes->{
  3.722751048052615*^9, {3.7227698153852825`*^9, 
   3.7227698174903994`*^9}},ExpressionUUID->"86481ea6-1b9c-4a4c-9c51-\
c12749f63f9d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Poke24", "[", 
    RowBox[{"{", 
     RowBox[{"3", ",", "7", ",", "6", ",", "1"}], "}"}], "]"}], "//", "TT"}], 
  "//", "TableForm"}]], "Input",
 CellChangeTimes->{3.722750840334982*^9, 
  3.72275733071987*^9},ExpressionUUID->"56bfc059-e223-4c51-97c6-bef307b7f28b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox["\<\"\:603b\:8fd0\:884c\:65f6: \"\>",
   "EchoLabel"], " ", "0.1315910280562188`"}]], "Echo",
 CellChangeTimes->{
  3.7227573313458586`*^9},ExpressionUUID->"15d528e7-0f4c-4afb-8241-\
8d09ae4d3394"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"CPU \:65f6\:95f4: \"\>",
   "EchoLabel"], " ", "0.140625`"}]], "Echo",
 CellChangeTimes->{
  3.7227573313658743`*^9},ExpressionUUID->"233bae0b-7c8f-45bf-bde3-\
21b331c00307"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["calfast", "Section",
 CellChangeTimes->{
  3.722751048052615*^9, {3.7227698153852825`*^9, 3.7227698174903994`*^9}, {
   3.722772555487835*^9, 
   3.7227725615315027`*^9}},ExpressionUUID->"c17fac3d-7b1a-4963-ad36-\
fa61d3795a4f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pow", "[", 
   RowBox[{"a_", ",", 
    RowBox[{"pow", "[", 
     RowBox[{"b_", ",", "c_"}], "]"}]}], "]"}], ":=", 
  "Null"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pow", "[", 
   RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"b", ">", "10"}], ",", "Null", ",", 
    RowBox[{"Power", "[", 
     RowBox[{"a", ",", "b"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"filter4", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"op1_", ",", "op2_", ",", "op3_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "}"}], ",", 
     RowBox[{"t_:", "24"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ans", "=", 
       RowBox[{"{", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Quiet", "@", 
          RowBox[{"op1", "[", 
           RowBox[{
            RowBox[{"op2", "[", 
             RowBox[{
              RowBox[{"op3", "[", 
               RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", "d"}], 
           "]"}]}], "\[Equal]", "24"}], ",", 
        RowBox[{
         RowBox[{"ans", "=", 
          RowBox[{"Union", "[", 
           RowBox[{"ans", ",", 
            RowBox[{"{", 
             RowBox[{"HoldForm", "@", 
              RowBox[{"op1", "[", 
               RowBox[{
                RowBox[{"op2", "[", 
                 RowBox[{
                  RowBox[{"op3", "[", 
                   RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                "d"}], "]"}]}], "}"}]}], "]"}]}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Quiet", "@", 
          RowBox[{"op1", "[", 
           RowBox[{
            RowBox[{"op2", "[", 
             RowBox[{"a", ",", "b"}], "]"}], ",", 
            RowBox[{"op3", "[", 
             RowBox[{"c", ",", "d"}], "]"}]}], "]"}]}], "\[Equal]", "24"}], 
        ",", 
        RowBox[{
         RowBox[{"ans", "=", 
          RowBox[{"Union", "[", 
           RowBox[{"ans", ",", 
            RowBox[{"{", 
             RowBox[{"HoldForm", "@", 
              RowBox[{"op1", "[", 
               RowBox[{
                RowBox[{"op2", "[", 
                 RowBox[{"a", ",", "b"}], "]"}], ",", 
                RowBox[{"op3", "[", 
                 RowBox[{"c", ",", "d"}], "]"}]}], "]"}]}], "}"}]}], "]"}]}], 
         ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Quiet", "@", 
          RowBox[{"op1", "[", 
           RowBox[{
            RowBox[{"op2", "[", 
             RowBox[{"a", ",", 
              RowBox[{"op3", "[", 
               RowBox[{"b", ",", "c"}], "]"}]}], "]"}], ",", "d"}], "]"}]}], 
         "\[Equal]", "24"}], ",", 
        RowBox[{
         RowBox[{"ans", "=", 
          RowBox[{"Union", "[", 
           RowBox[{"ans", ",", 
            RowBox[{"{", 
             RowBox[{"HoldForm", "@", 
              RowBox[{"op1", "[", 
               RowBox[{
                RowBox[{"op2", "[", 
                 RowBox[{"a", ",", 
                  RowBox[{"op3", "[", 
                   RowBox[{"b", ",", "c"}], "]"}]}], "]"}], ",", "d"}], 
               "]"}]}], "}"}]}], "]"}]}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Quiet", "@", 
          RowBox[{"op1", "[", 
           RowBox[{"a", ",", 
            RowBox[{"op2", "[", 
             RowBox[{
              RowBox[{"op3", "[", 
               RowBox[{"b", ",", "c"}], "]"}], ",", "d"}], "]"}]}], "]"}]}], 
         "\[Equal]", "24"}], ",", 
        RowBox[{
         RowBox[{"ans", "=", 
          RowBox[{"Union", "[", 
           RowBox[{"ans", ",", 
            RowBox[{"{", 
             RowBox[{"HoldForm", "@", 
              RowBox[{"op1", "[", 
               RowBox[{"a", ",", 
                RowBox[{"op2", "[", 
                 RowBox[{
                  RowBox[{"op3", "[", 
                   RowBox[{"b", ",", "c"}], "]"}], ",", "d"}], "]"}]}], 
               "]"}]}], "}"}]}], "]"}]}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Quiet", "@", 
          RowBox[{"op1", "[", 
           RowBox[{"a", ",", 
            RowBox[{"op2", "[", 
             RowBox[{"b", ",", 
              RowBox[{"op3", "[", 
               RowBox[{"c", ",", "d"}], "]"}]}], "]"}]}], "]"}]}], "\[Equal]",
          "24"}], ",", 
        RowBox[{
         RowBox[{"ans", "=", 
          RowBox[{"Union", "[", 
           RowBox[{"ans", ",", 
            RowBox[{"{", 
             RowBox[{"HoldForm", "@", 
              RowBox[{"op1", "[", 
               RowBox[{"a", ",", 
                RowBox[{"op2", "[", 
                 RowBox[{"b", ",", 
                  RowBox[{"op3", "[", 
                   RowBox[{"c", ",", "d"}], "]"}]}], "]"}]}], "]"}]}], 
             "}"}]}], "]"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "ans"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cal24", "[", "nums_List", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ops", ",", 
      RowBox[{"num", "=", "nums"}], ",", "rule", ",", "same"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ops", "=", 
      RowBox[{"{", 
       RowBox[{
       "Plus", ",", "Subtract", ",", "Times", ",", "Divide", ",", "pow", ",", 
        "Log", ",", "Surd"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rule", "=", 
      RowBox[{"Thread", "[", 
       RowBox[{"num", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"n1", ",", "n2", ",", "n3", ",", "n4"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"same", "[", 
       RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p", ",", "q"}], "}"}], ",", 
        RowBox[{
         RowBox[{"p", "=", 
          RowBox[{"a", "/.", "rule"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"q", "=", 
          RowBox[{"b", "/.", "rule"}]}], ";", 
         RowBox[{
          RowBox[{"ReleaseHold", "[", "p", "]"}], "===", 
          RowBox[{"ReleaseHold", "[", "q", "]"}]}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{
       RowBox[{"Union", "@@", 
        RowBox[{"filter4", "@@@", 
         RowBox[{"Tuples", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{"ops", ",", "3"}], "]"}], ",", 
            RowBox[{"Permutations", "[", "num", "]"}]}], "}"}], "]"}]}]}], 
       ",", "same"}], "]"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.722750831377653*^9, 3.7227508313806562`*^9}, {
  3.7227721034104247`*^9, 3.7227721192049503`*^9}, {3.7227722026826878`*^9, 
  3.722772206443494*^9}},ExpressionUUID->"dc4bb383-f6b3-46ad-8ce2-\
ee21e0582c87"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"cal24", "[", 
      RowBox[{"{", 
       RowBox[{"3", ",", "7", ",", "6", ",", "2"}], "}"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{"pow", "\[Rule]", "Power"}], "}"}]}], "/.", 
    RowBox[{
     RowBox[{"HoldForm", "[", "x__", "]"}], "\[RuleDelayed]", 
     RowBox[{"HoldForm", "[", 
      RowBox[{"InputForm", "[", "x", "]"}], "]"}]}]}], "//", "TableForm"}], "//",
   "TT"}]], "Input",
 CellChangeTimes->{
  3.722750840334982*^9, 3.72275733071987*^9, {3.7227725666688094`*^9, 
   3.7227726004582086`*^9}, {3.7227726394907446`*^9, 
   3.7227726407829533`*^9}, {3.722812329685876*^9, 3.7228123365423326`*^9}, {
   3.722812376511538*^9, 
   3.722812378324284*^9}},ExpressionUUID->"e9273c38-af11-43aa-8f1e-\
084a6bcacbbc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox["\<\"\:603b\:8fd0\:884c\:65f6: \"\>",
   "EchoLabel"], " ", "1.4280726406846431`"}]], "Echo",
 CellChangeTimes->{
  3.722812380046183*^9},ExpressionUUID->"b3ec3ffb-64ef-4db6-80e5-\
67291f28d688"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"CPU \:65f6\:95f4: \"\>",
   "EchoLabel"], " ", "1.4375`"}]], "Echo",
 CellChangeTimes->{
  3.7228123800581913`*^9},ExpressionUUID->"658cf12b-3703-44c0-af65-\
8175befc9e86"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      TagBox[
       InterpretationBox[
        StyleBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"7", "*", "2"}], " ", "-", " ", "6"}], ")"}], "*", "3"}],
         ShowStringCharacters->True,
         NumberMarks->True],
        InputForm[Subtract[7 2, 6] 3],
        AutoDelete->True,
        Editable->True],
       HoldForm]},
     {
      TagBox[
       InterpretationBox[
        StyleBox[
         RowBox[{
          RowBox[{
           RowBox[{"7", "/", "2"}], "*", "6"}], " ", "+", " ", "3"}],
         ShowStringCharacters->True,
         NumberMarks->True],
        InputForm[Divide[7, 2] 6 + 3],
        AutoDelete->True,
        Editable->True],
       HoldForm]},
     {
      TagBox[
       InterpretationBox[
        StyleBox[
         RowBox[{
          RowBox[{"6", "/", "2"}], " ", "+", " ", 
          RowBox[{"7", "*", "3"}]}],
         ShowStringCharacters->True,
         NumberMarks->True],
        InputForm[Divide[6, 2] + 7 3],
        AutoDelete->True,
        Editable->True],
       HoldForm]},
     {
      TagBox[
       InterpretationBox[
        StyleBox[
         RowBox[{
          RowBox[{"6", "^", "3"}], "/", 
          RowBox[{"(", 
           RowBox[{"7", " ", "+", " ", "2"}], ")"}]}],
         ShowStringCharacters->True,
         NumberMarks->True],
        InputForm[
         Divide[6^3, 7 + 2]],
        AutoDelete->True,
        Editable->True],
       HoldForm]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7227725682346992`*^9, 3.722772603831473*^9}, 
   3.7227726467800803`*^9, {3.722812373057616*^9, 
   3.7228123800842233`*^9}},ExpressionUUID->"c3fd59dd-3cae-44e9-a2e4-\
dfde4b43a085"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Switch", "[", 
  RowBox[{
   RowBox[{"OptionValue", "[", "Extension", "]"}], ",", "\[IndentingNewLine]",
    "False", ",", 
   RowBox[{"cal24", "[", 
    RowBox[{"Extension", "->", 
     RowBox[{"{", 
      RowBox[{"Plus", ",", "Subtract", ",", "Times", ",", "Divide"}], "}"}]}],
     "]"}], ",", "\[IndentingNewLine]", "True", ",", 
   RowBox[{"cal24", "[", 
    RowBox[{"Extension", "->", 
     RowBox[{"{", 
      RowBox[{
      "Plus", ",", "Subtract", ",", "Times", ",", "Divide", ",", "pow", ",", 
       "Log", ",", "Surd"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
   "All", ",", "\[IndentingNewLine]", "__", ",", 
   RowBox[{"cal24", "[", 
    RowBox[{"Extension", "->", 
     RowBox[{"OptionValue", "[", "Extension", "]"}]}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",ExpressionUUID->"bfad45d9-d152-43b6-\
9854-91db15c29a7a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"treeR", "[", "1", "]"}], "=", "n"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"treeR", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"treeR", "[", "n", "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"o", "[", 
      RowBox[{
       RowBox[{"treeR", "[", "a", "]"}], ",", 
       RowBox[{"treeR", "[", 
        RowBox[{"n", "-", "a"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "1", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"treeC", "[", "n_", "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"treeR", "[", "n", "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"o", "[", 
        RowBox[{"a_List", ",", "b_"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"o", "[", 
           RowBox[{"#", ",", "b"}], "]"}], "&"}], "/@", "a"}], ")"}]}], ",", 
      RowBox[{
       RowBox[{"o", "[", 
        RowBox[{"a_", ",", "b_List"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"o", "[", 
           RowBox[{"a", ",", "#"}], "]"}], "&"}], "/@", "b"}], ")"}]}]}], 
     "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"treeC", "[", "4", "]"}], "//", "TableForm"}]}], "Input",
 CellChangeTimes->{{3.7228081286361327`*^9, 3.7228081371869326`*^9}, 
   3.7228087986595435`*^9, {3.72280966173053*^9, 3.722809664076749*^9}, {
   3.722811412948248*^9, 
   3.72281141361786*^9}},ExpressionUUID->"5f76ae6d-cd22-43fd-ba44-\
5f589cb69be2"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{"o", "[", 
       RowBox[{"n", ",", 
        RowBox[{"o", "[", 
         RowBox[{"n", ",", 
          RowBox[{"o", "[", 
           RowBox[{"n", ",", "n"}], "]"}]}], "]"}]}], "]"}]},
     {
      RowBox[{"o", "[", 
       RowBox[{"n", ",", 
        RowBox[{"o", "[", 
         RowBox[{
          RowBox[{"o", "[", 
           RowBox[{"n", ",", "n"}], "]"}], ",", "n"}], "]"}]}], "]"}]},
     {
      RowBox[{"o", "[", 
       RowBox[{
        RowBox[{"o", "[", 
         RowBox[{"n", ",", "n"}], "]"}], ",", 
        RowBox[{"o", "[", 
         RowBox[{"n", ",", "n"}], "]"}]}], "]"}]},
     {
      RowBox[{"o", "[", 
       RowBox[{
        RowBox[{"o", "[", 
         RowBox[{"n", ",", 
          RowBox[{"o", "[", 
           RowBox[{"n", ",", "n"}], "]"}]}], "]"}], ",", "n"}], "]"}]},
     {
      RowBox[{"o", "[", 
       RowBox[{
        RowBox[{"o", "[", 
         RowBox[{
          RowBox[{"o", "[", 
           RowBox[{"n", ",", "n"}], "]"}], ",", "n"}], "]"}], ",", "n"}], 
       "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7228081304938517`*^9, 3.7228081374211197`*^9}, {
   3.72280879956536*^9, 3.7228088028894844`*^9}, 3.7228089477773104`*^9, 
   3.722809664320228*^9, 3.7228102231210155`*^9, 3.722811414025814*^9, {
   3.722811691389675*^9, 3.722811712204655*^9}, 3.7228127333402348`*^9, 
   3.722813748827916*^9},ExpressionUUID->"5fb3fef8-0097-41a9-bad7-\
8ce799b49855"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"plus", "[", 
   RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{"Plus", "[", 
   RowBox[{"a", ",", "b"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minus", "[", 
   RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{"Subtract", "[", 
   RowBox[{"a", ",", "b"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"times", "[", 
   RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Times", "[", 
      RowBox[{"a", ",", "b"}], "]"}], ">", 
     RowBox[{"10", "^", "6"}]}], ",", "$Failed", ",", 
    RowBox[{"Times", "[", 
     RowBox[{"a", ",", "b"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"div", "[", 
   RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{"Divide", "[", 
   RowBox[{"a", ",", "b"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pow", "[", 
   RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{"Power", "[", 
   RowBox[{"a", ",", "b"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"log", "[", 
   RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{"Log", "[", 
   RowBox[{"a", ",", "b"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"root", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{"Power", "[", 
    RowBox[{"a", ",", 
     RowBox[{"1", "/", "b"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pow", "[", 
    RowBox[{"a_", ",", 
     RowBox[{"pow", "[", 
      RowBox[{"b_", ",", "c_"}], "]"}]}], "]"}], ":=", "$Failed"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pow", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{"$Failed", "/;", 
    RowBox[{"b", ">", "10"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plus", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{"$Failed", "/;", 
    RowBox[{"a", ">", 
     RowBox[{"10", "^", "6"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plus", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{"$Failed", "/;", 
    RowBox[{"b", ">", 
     RowBox[{"10", "^", "6"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"div", "[", 
    RowBox[{"a_", ",", "0"}], "]"}], ":=", "$Failed"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"div", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{"$Failed", "/;", 
    RowBox[{"b", ">", 
     RowBox[{"10", "^", "3"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"log", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{"$Failed", "/;", 
    RowBox[{"a", "<", "0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"root", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], ":=", "$Failed"}], ";"}], 
  "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7228131324291515`*^9, 3.7228133168463945`*^9}, {
  3.722813347130682*^9, 3.7228133703205924`*^9}, {3.722813435757415*^9, 
  3.7228134451760535`*^9}, {3.722813498803961*^9, 3.722813506595061*^9}, {
  3.722813559458604*^9, 3.722813563360936*^9}, {3.7228136203046613`*^9, 
  3.7228137311405687`*^9}, {3.7228137883134995`*^9, 
  3.7228137990700054`*^9}},ExpressionUUID->"8cd96923-e5d4-4f06-83c4-\
df87ba4d3d23"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cal", "[", 
   RowBox[{"nn_", ",", "oo_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", 
      RowBox[{
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"#", ",", "n"}], "]"}], "\[Rule]", "nn"}], "]"}], "~", 
       "Join", "~", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"#", ",", "o"}], "]"}], "\[Rule]", "oo"}], "]"}]}]}], "]"}],
     "&"}], "/@", 
   RowBox[{"treeC", "[", "4", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"all", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"cal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"3", ",", "7", ",", "6", ",", "2"}], "}"}], ",", "#"}], "]"}],
      "&"}], "/@", 
    RowBox[{"Tuples", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\:52a0", ",", "\:51cf", ",", "\:4e58", ",", "\:9664", ",", "\:5e42", 
        ",", "\:5bf9", ",", "\:6839"}], "}"}], ",", "3"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"all", "/.", 
  RowBox[{"Thread", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\:52a0", ",", "\:51cf", ",", "\:4e58", ",", "\:9664", ",", "\:5e42", 
      ",", "\:5bf9", ",", "\:6839"}], "}"}], "->", 
    RowBox[{"{", 
     RowBox[{
     "plus", ",", "minus", ",", "times", ",", "div", ",", "pow", ",", "log", 
      ",", "root"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7228115595562763`*^9, 3.72281161434976*^9}, {
   3.722811645177125*^9, 3.7228116493600163`*^9}, {3.72281199867073*^9, 
   3.722812003001994*^9}, {3.722812040508519*^9, 3.7228121787576847`*^9}, {
   3.7228122330480614`*^9, 3.7228122502325034`*^9}, {3.722812455390893*^9, 
   3.7228125124178042`*^9}, {3.7228128806476393`*^9, 
   3.7228129222322807`*^9}, {3.72281297005202*^9, 3.722813117999039*^9}, 
   3.7228132375961695`*^9},ExpressionUUID->"8a81be94-6c6e-449f-a3ee-\
bdf544b2771a"]
}, Open  ]]
},
WindowSize->{826, 873},
WindowMargins->{{84, Automatic}, {48, Automatic}},
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (2017\:5e7410\:67082\
\:65e5)",
StyleDefinitions->FrontEnd`FileName[{"Report"}, "StandardReport.nb", 
  CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 133, 3, 68, "Section",ExpressionUUID->"4be31f26-bcb2-4dea-ad26-3cf462e3832a"],
Cell[716, 27, 4578, 128, 219, "Input",ExpressionUUID->"635d6187-735e-4616-a324-13e291f0ae25"],
Cell[CellGroupData[{
Cell[5319, 159, 398, 10, 38, "Input",ExpressionUUID->"7a4c0846-eaca-4287-8908-a3b102a4386f"],
Cell[CellGroupData[{
Cell[5742, 173, 229, 6, 22, "Echo",ExpressionUUID->"bf3bc895-ed80-42e7-a6b6-eed2e8fee2d5"],
Cell[5974, 181, 210, 6, 22, "Echo",ExpressionUUID->"2b280299-044a-45fd-9736-0679d40d5374"]
}, Open  ]],
Cell[6199, 190, 1105, 31, 191, "Output",ExpressionUUID->"2e1736c8-1a51-45fb-96f0-f1a4cfaeeca9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7341, 226, 269, 6, 38, "Input",ExpressionUUID->"b434bd63-a539-4b92-bb71-110ae09d7a50"],
Cell[7613, 234, 1714, 56, 106, "Output",ExpressionUUID->"c7029ffc-5579-461c-9d8c-bb9e583acb2e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9364, 295, 307, 8, 38, "Input",ExpressionUUID->"cfdec555-031a-4b1c-9973-8478f59864b7"],
Cell[9674, 305, 281, 8, 38, "Output",ExpressionUUID->"90b6e39a-0a1d-4b63-84fc-5d164fd87766"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[10004, 319, 128, 3, 68, "Section",ExpressionUUID->"a0e47a12-79c3-4e9a-9053-bbfe6bae5730"],
Cell[CellGroupData[{
Cell[10157, 326, 158, 3, 38, "Input",ExpressionUUID->"359ac8a6-b74c-460a-9d1c-44eb64ff13c9"],
Cell[10318, 331, 246, 6, 22, "Echo",ExpressionUUID->"777057a7-7ceb-4237-ae8a-0a58cfc4a9ff"]
}, Open  ]],
Cell[10579, 340, 7366, 191, 291, "Input",ExpressionUUID->"89190d68-8c41-4fc8-8c7b-cfb618f7a575"],
Cell[CellGroupData[{
Cell[17970, 535, 949, 20, 38, "Input",ExpressionUUID->"91822627-1337-4a94-9c1c-a2527b6d771e"],
Cell[CellGroupData[{
Cell[18944, 559, 230, 6, 22, "Echo",ExpressionUUID->"b6b11927-dda7-4771-aad9-74dd04aff0e0"],
Cell[19177, 567, 212, 6, 22, "Echo",ExpressionUUID->"0d6a86cd-0c74-4681-b339-b7e5e6dec104"]
}, Open  ]],
Cell[19404, 576, 2211, 59, 55, "Output",ExpressionUUID->"4e406e45-fc52-468c-88ad-f295ea27b94e"]
}, Open  ]],
Cell[21630, 638, 595, 19, 57, "Input",ExpressionUUID->"cbd02068-2ec3-45ff-b853-6b8548bafba9"],
Cell[CellGroupData[{
Cell[22250, 661, 4275, 120, 327, "Input",ExpressionUUID->"36aea2c4-6775-48d1-8fed-b0f3041c5564"],
Cell[26528, 783, 2366, 64, 106, "Output",ExpressionUUID->"7d0ec301-ac32-4036-9087-6579a21fc81f"],
Cell[28897, 849, 4272, 124, 111, "Output",ExpressionUUID->"4640ecb6-f6e5-46cb-b773-825b47fb0dba"],
Cell[33172, 975, 1309, 18, 111, "Output",ExpressionUUID->"e03c474a-dfd3-405d-b9ed-97dd4ad57902"],
Cell[34484, 995, 891, 13, 57, "Output",ExpressionUUID->"b8e7a60c-bf36-4a3f-a351-129898ccce7f"],
Cell[35378, 1010, 889, 13, 57, "Output",ExpressionUUID->"1cfdd644-9c99-486e-a963-bb7a74084471"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36304, 1028, 132, 3, 38, "Input",ExpressionUUID->"d541cf2e-4bc8-4229-a42f-f4c5294891fe"],
Cell[36439, 1033, 246, 6, 22, "Echo",ExpressionUUID->"6d68ab79-5aee-4eef-b0ad-241c7880f7b5"]
}, Open  ]],
Cell[36700, 1042, 422, 9, 165, "Input",ExpressionUUID->"e2323887-a5d8-4b87-ab59-b82e40f84da8"],
Cell[CellGroupData[{
Cell[37147, 1055, 2355, 61, 165, "Input",ExpressionUUID->"e73a7714-4583-4f7a-a120-1ebcd80cda99"],
Cell[CellGroupData[{
Cell[39527, 1120, 229, 6, 22, "Echo",ExpressionUUID->"69d7083f-0ae3-45a8-938c-4831b5bcdf19"],
Cell[39759, 1128, 209, 6, 22, "Echo",ExpressionUUID->"806ec6c4-5b3a-4571-8ffe-bf2445ddbc18"]
}, Open  ]],
Cell[39983, 1137, 1139, 34, 276, "Output",ExpressionUUID->"c08fb4de-6570-47fd-894e-d0067ee21353"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[41171, 1177, 182, 4, 68, "Section",ExpressionUUID->"86481ea6-1b9c-4a4c-9c51-c12749f63f9d"],
Cell[CellGroupData[{
Cell[41378, 1185, 312, 8, 38, "Input",ExpressionUUID->"56bfc059-e223-4c51-97c6-bef307b7f28b"],
Cell[CellGroupData[{
Cell[41715, 1197, 230, 6, 22, "Echo",ExpressionUUID->"15d528e7-0f4c-4afb-8241-8d09ae4d3394"],
Cell[41948, 1205, 212, 6, 22, "Echo",ExpressionUUID->"233bae0b-7c8f-45bf-bde3-21b331c00307"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[42221, 1218, 234, 5, 68, "Section",ExpressionUUID->"c17fac3d-7b1a-4963-ad36-fa61d3795a4f"],
Cell[42458, 1225, 7219, 204, 327, "Input",ExpressionUUID->"dc4bb383-f6b3-46ad-8ce2-ee21e0582c87"],
Cell[CellGroupData[{
Cell[49702, 1433, 801, 21, 38, "Input",ExpressionUUID->"e9273c38-af11-43aa-8f1e-084a6bcacbbc"],
Cell[CellGroupData[{
Cell[50528, 1458, 228, 6, 22, "Echo",ExpressionUUID->"b3ec3ffb-64ef-4db6-80e5-67291f28d688"],
Cell[50759, 1466, 210, 6, 22, "Echo",ExpressionUUID->"658cf12b-3703-44c0-af65-8175befc9e86"]
}, Open  ]],
Cell[50984, 1475, 2200, 75, 103, "Output",ExpressionUUID->"c3fd59dd-3cae-44e9-a2e4-dfde4b43a085"]
}, Open  ]],
Cell[53199, 1553, 873, 21, 129, "Input",ExpressionUUID->"bfad45d9-d152-43b6-9854-91db15c29a7a"],
Cell[CellGroupData[{
Cell[54097, 1578, 1632, 48, 93, "Input",ExpressionUUID->"5f76ae6d-cd22-43fd-ba44-5f589cb69be2"],
Cell[55732, 1628, 1932, 58, 120, "Output",ExpressionUUID->"5fb3fef8-0097-41a9-bad7-8ce799b49855"]
}, Open  ]],
Cell[57679, 1689, 3391, 103, 363, "Input",ExpressionUUID->"8cd96923-e5d4-4f06-83c4-df87ba4d3d23"],
Cell[61073, 1794, 1995, 54, 75, "Input",ExpressionUUID->"8a81be94-6c6e-449f-a3ee-bdf544b2771a"]
}, Open  ]]
}
]
*)

