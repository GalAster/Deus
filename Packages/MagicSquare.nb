Notebook[{

Cell[CellGroupData[{
Cell["MagicSquare", \
"Title",ExpressionUUID->"53dac037-6aca-4226-9f8c-169b46de1289"],

Cell[CellGroupData[{

Cell["\:7a0b\:5e8f\:5305\:4ecb\:7ecd", \
"Subchapter",ExpressionUUID->"c18b155c-8d5b-4135-91e9-c4f6205c84e2"],

Cell["\<\
Mathematica Package
Created by Mathematica Plugin for IntelliJ IDEA
Establish from GalAster's template

Author:GalAster
Creation Date:2016-07-12
Copyright:CC4.0 BY+NA+NC

\:8be5\:8f6f\:4ef6\:5305\:9075\:4eceCC\:534f\:8bae:\:7f72\:540d\:3001\:975e\
\:5546\:4e1a\:6027\:4f7f\:7528\:3001\:76f8\:540c\:65b9\:5f0f\:5171\:4eab

\:8fd9\:91cc\:5e94\:8be5\:586b\:8fd9\:4e2a\:51fd\:6570\:7684\:4ecb\:7ecd\
\>", "Text",ExpressionUUID->"4676a772-b7c0-4d7a-8c51-c344c1b82c5d"],

Cell[CellGroupData[{

Cell["\:51fd\:6570\:8bf4\:660e", \
"Section",ExpressionUUID->"2f3b027f-dd0e-4721-8eb9-6c759ff051c7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Magic", "::", "usage"}], " ", "=", " ", 
   "\"\<Magic[n]\:53ef\:4ee5\:751f\:6210n\[Times]n\:7684\:5e7b\:65b9.\\r \
Magic[n,d]\:751f\:6210d\:7ef4\:7684n\:9636\:5e7b\:65b9.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MagicQ", "::", "usage"}], " ", "=", " ", 
   "\"\<MagicQ[n]\:68c0\:6d4b\:4e00\:4e2an\[Times]n\:5e7b\:65b9.\\r \
MagicQ[n,3D]\:68c0\:6d4b\:4e00\:4e2an\[Times]n\[Times]n\:5e7b\:7acb\:65b9.\>\"\
"}], ";"}]}], "Code",
 CellChangeTimes->{{3.723093858521307*^9, 
  3.7230938586774426`*^9}},ExpressionUUID->"ac67ce71-2076-408f-843e-\
781ccab73c58"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:7a0b\:5e8f\:5305\:6b63\:4f53", \
"Section",ExpressionUUID->"66e28c9e-0384-4440-9ab9-b32f8980bd19"],

Cell[CellGroupData[{

Cell["\:4e3b\:8bbe\:7f6e", \
"Subsection",ExpressionUUID->"0e696848-304e-4413-857e-98592797f878"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MagicSquare", "::", "usage"}], " ", "=", " ", 
   "\"\<\:5e7b\:65b9\:5305\:63d0\:4f9b\:4e86\:4e00\:7cfb\:5217\:5e7b\:65b9\
\:7684\:7b97\:6cd5.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`MagicSquare`\>\"", "]"}], 
  ";"}]}], "Code",ExpressionUUID->"e1d7d7f2-fa2d-4173-b073-cecbbb647b94"]
}, Closed]],

Cell[CellGroupData[{

Cell["\:4e3b\:4f53\:4ee3\:7801", \
"Subsection",ExpressionUUID->"7e166554-9abd-4e9f-8e70-afa1995512a4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MagicSquare$Version", "=", "\"\<V1.4.0\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"MagicSquare$LastUpdate", "=", "\"\<2017-12-17\>\""}], 
  ";"}]}], "Code",ExpressionUUID->"7730cdba-5e6c-43d3-9a7f-9b1100b67631"],

Cell[CellGroupData[{

Cell["\:5e7b\:65b9\:9009\:9879\:4ee3\:7801", \
"Subsubsection",ExpressionUUID->"36226b85-d359-4634-9937-07aba13ff4ce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Magic", "::", "nosol"}], "=", "\"\<\:65e0\:89e3.\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Magic", "::", "nodef"}], "=", "\"\<\:65e0\:5b9a\:4e49.\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Magic", "::", "novpn"}], "=", 
   "\"\<\:6570\:636e\:5e93\:8bf7\:6c42\:5931\:8d25,\:4f60\:53ef\:80fd\:9700\
\:8981VPN,\:6216\:8005\:4f60\:8981\:6c42\:7684\:6570\:636e\:91cf\:592a\:8fc7\
\:5de8\:5927,\:53ef\:4ee5\:4f7f\:7528 TimeConstraint \:9009\:9879\:589e\:52a0\
\:8bf7\:6c42\:65f6\:957f.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Magic", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Method", "->", "\"\<Simple\>\""}], ",", 
     RowBox[{"TimeConstraint", "->", "5"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Magic", "[", 
    RowBox[{"n_", ",", "d_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"TimeConstrained", "[", 
    RowBox[{
     RowBox[{"MagicLinker", "[", 
      RowBox[{"n", ",", "d", ",", 
       RowBox[{"OptionValue", "[", "Method", "]"}]}], "]"}], ",", 
     RowBox[{"OptionValue", "[", "TimeConstraint", "]"}], ",", 
     RowBox[{"Message", "[", 
      RowBox[{"Magic", "::", "novpn"}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MagicLinker", "[", 
    RowBox[{"n_", ",", "d_", ",", "p_"}], "]"}], ":=", 
   RowBox[{"URLExecute", "[", 
    RowBox[{
     RowBox[{
     "\"\<http://magichypercube.com/rest/hypercube/\>\"", "<>", "p", "<>", 
      "\"\</\>\"", "<>", 
      RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\</\>\"", "<>", 
      RowBox[{"ToString", "[", "d", "]"}], "<>", "\"\</true\>\""}], ",", 
     "\"\<CSV\>\""}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Magic", ",", "Magic3D"}], "}"}], ",", "Listable"}], "]"}], 
  ";"}]}], "Code",ExpressionUUID->"7a3a3949-94cb-4afe-9d6c-d4f466f3d570"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:5e7b\:65b9\:751f\:6210\:6838\:5fc3\:4ee3\:7801", \
"Subsubsection",ExpressionUUID->"4477c0f9-2c1e-491a-89c5-8c315bf5506d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Magic", "[", 
    RowBox[{"n_", "?", "OddQ"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "p", "}"}], ",", 
     RowBox[{
      RowBox[{"p", "=", 
       RowBox[{"Range", "[", "n", "]"}]}], ";", "\n", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Outer", "[", 
          RowBox[{"Plus", ",", "p", ",", 
           RowBox[{"p", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "+", "3"}], ")"}], "/", "2"}]}]}], "]"}], "~", 
         "Mod", "~", "n"}], "*", "n"}], "+", 
       RowBox[{
        RowBox[{"Outer", "[", 
         RowBox[{"Plus", ",", "p", ",", 
          RowBox[{
           RowBox[{"2", "p"}], "-", "2"}]}], "]"}], "~", "Mod", "~", "n"}], 
       "+", "1"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Magic", "[", 
    RowBox[{"n_", "/;", 
     RowBox[{
      RowBox[{"n", "~", "Mod", "~", "4"}], "==", "0"}]}], "]"}], ":=", "\n", 
   RowBox[{
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"J", ",", "K1", ",", "M"}], "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"J", "=", 
        RowBox[{"Floor", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Range", "[", "n", "]"}], "~", "Mod", "~", "4"}], ")"}], 
          "/", "2.0"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"K1", "=", 
        RowBox[{
         RowBox[{"Abs", "@", 
          RowBox[{"Outer", "[", 
           RowBox[{"Plus", ",", "J", ",", 
            RowBox[{"-", "J"}]}], "]"}]}], "~", "BitXor", "~", "1"}]}], ";", 
       "\n", "\t", 
       RowBox[{"M", "=", 
        RowBox[{"Outer", "[", 
         RowBox[{"Plus", ",", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", 
            RowBox[{"n", "^", "2"}], ",", "n"}], "]"}], ",", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", 
            RowBox[{"n", "-", "1"}]}], "]"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"M", "+", 
        RowBox[{"K1", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"n", "*", "n"}], "+", "1", "-", 
           RowBox[{"2", "M"}]}], ")"}]}]}]}]}], "\n", "]"}], "//", 
    "Experimental`CompileEvaluate"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Magic", "[", "2", "]"}], ":=", 
   RowBox[{"Message", "[", 
    RowBox[{"Magic", "::", "nosol"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Magic", "[", 
    RowBox[{"n_", "?", "EvenQ"}], "]"}], ":=", "\n", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", ",", "M", ",", "i", ",", "j", ",", "k"}], "}"}], ",", "\n",
      "\t", 
     RowBox[{
      RowBox[{"p", "=", 
       RowBox[{"n", "/", "2"}]}], ";", "\n", "\t", 
      RowBox[{"M", "=", 
       RowBox[{"Magic", "[", "p", "]"}]}], ";", "\n", "\t", 
      RowBox[{"M", "=", 
       RowBox[{"ArrayFlatten", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"M", ",", 
            RowBox[{"M", "+", 
             RowBox[{"2", 
              RowBox[{"p", "^", "2"}]}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"M", "+", 
             RowBox[{"3", 
              RowBox[{"p", "^", "2"}]}]}], ",", 
            RowBox[{"M", "+", 
             RowBox[{"p", "^", "2"}]}]}], "}"}]}], "}"}]}]}], ";", "\n", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n", "==", "2"}], ",", 
        RowBox[{"Return", "[", "M", "]"}]}], "]"}], ";", "\n", "\t", 
      RowBox[{"i", "=", 
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"Range", "@", "p"}], "}"}]}]}], ";", "\n", "\t", 
      RowBox[{"k", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "2"}], ")"}], "/", "4"}]}], ";", "\n", "\t", 
      RowBox[{"j", "=", 
       RowBox[{
        RowBox[{"Range", "[", "k", "]"}], "~", "Join", "~", 
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{"n", "-", "k", "+", "2"}], ",", "n"}], "]"}]}]}], ";", "\n",
       "\t", 
      RowBox[{
       RowBox[{"M", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"Flatten", "@", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"i", "+", "p"}]}], "}"}]}], ",", "j"}], "]"}], "]"}], 
       "=", 
       RowBox[{"M", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"Flatten", "@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"i", "+", "p"}], ",", "i"}], "}"}]}], ",", "j"}], "]"}], 
        "]"}]}], ";", "\n", "\t", 
      RowBox[{"i", "=", 
       RowBox[{"k", "+", "1"}]}], ";", 
      RowBox[{"j", "=", 
       RowBox[{"{", 
        RowBox[{"1", ",", "i"}], "}"}]}], ";", "\n", "\t", 
      RowBox[{
       RowBox[{"M", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"Flatten", "@", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"i", "+", "p"}]}], "}"}]}], ",", "j"}], "]"}], "]"}], 
       "=", 
       RowBox[{"M", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"Flatten", "@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"i", "+", "p"}], ",", "i"}], "}"}]}], ",", "j"}], "]"}], 
        "]"}]}], ";", "\n", "\t", "M"}]}], "\n", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Magic", "[", "x_", "]"}], ":=", 
   RowBox[{"Message", "[", 
    RowBox[{"Magic", "::", "nodef"}], "]"}]}], 
  ";"}]}], "Code",ExpressionUUID->"de089824-3a05-41cf-b13a-3f7ec3be5b0a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["3D\:5e7b\:65b9\:751f\:6210\:6838\:5fc3\:4ee3\:7801", \
"Subsubsection",ExpressionUUID->"9991f0fe-7f17-477b-b36f-b209dbcc89f5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Magic", "[", 
    RowBox[{"n_", ",", "3"}], "]"}], ":=", 
   RowBox[{"Magic3D", "[", "n", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Magic3D", "[", 
    RowBox[{"n_", "?", "OddQ"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"n", "^", "2"}], 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"i", "-", "j", "+", "k", "-", "1"}], ",", "n"}], "]"}]}], 
      "+", 
      RowBox[{"n", " ", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"i", "-", "j", "-", "k"}], ",", "n"}], "]"}]}], "+", 
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"i", "+", "j", "+", "k", "-", "2"}], ",", "n"}], "]"}], "+", 
      "1"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Magic3D", "[", 
    RowBox[{"n_", "/;", 
     RowBox[{
      RowBox[{"n", "~", "Mod", "~", "4"}], "==", "0"}]}], "]"}], ":=", "\n", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"QMagic", ",", "FMagic"}], "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{"QMagic", "[", "x_", "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"1", "<=", "x", "<=", 
          RowBox[{"n", "/", "2"}]}], ",", "0", ",", "1"}], "]"}]}], ";", "\n",
       "\t", 
      RowBox[{
       RowBox[{"FMagic", "[", 
        RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"i", "+", "j", "+", "k", "+", 
          RowBox[{"QMagic", "[", "i", "]"}], "+", 
          RowBox[{"QMagic", "[", "j", "]"}], "+", 
          RowBox[{"QMagic", "[", "k", "]"}]}], ",", "2"}], "]"}]}], ";", "\n",
       "\t", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"FMagic", "[", 
            RowBox[{"i", ",", "j", ",", "k"}], "]"}], "==", "1"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}], 
            RowBox[{"n", "^", "2"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"j", "-", "1"}], ")"}], "n"}], "+", "k"}], ",", 
          RowBox[{"1", "-", "k", "+", 
           RowBox[{"n", 
            RowBox[{"(", 
             RowBox[{"1", "-", "j", "+", 
              RowBox[{"n", 
               RowBox[{"(", 
                RowBox[{"1", "-", "i", "+", "n"}], ")"}]}]}], ")"}]}]}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}]}]}], "\n", "]"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Magic3D", "[", "2", "]"}], ":=", 
   RowBox[{"Message", "[", 
    RowBox[{"Magic", "::", "nosol"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Magic3D", "[", 
    RowBox[{"n_", "?", "EvenQ"}], "]"}], ":=", "\n", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "QMagic", ",", "XMagic", ",", "d", ",", "uptab", ",", "downtab"}], 
      "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{"QMagic", "[", "x_", "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"1", "<=", "x", "<=", 
          RowBox[{"n", "/", "2"}]}], ",", "0", ",", "1"}], "]"}]}], ";", "\n",
       "\t", 
      RowBox[{
       RowBox[{"XMagic", "[", "x_", "]"}], ":=", 
       RowBox[{"Min", "[", 
        RowBox[{"x", ",", 
         RowBox[{"n", "+", "1", "-", "x"}]}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"u", "=", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"XMagic", "[", "i", "]"}], "-", 
           RowBox[{"XMagic", "[", "j", "]"}], "+", 
           RowBox[{"XMagic", "[", "k", "]"}]}], ",", 
          RowBox[{"n", "/", "2"}]}], "]"}], "+", "1"}]}], ";", "\n", "\t", 
      RowBox[{"v", "=", 
       RowBox[{
        RowBox[{"4", 
         RowBox[{"QMagic", "[", "i", "]"}]}], "+", 
        RowBox[{"2", 
         RowBox[{"QMagic", "[", "j", "]"}]}], "+", 
        RowBox[{"QMagic", "[", "k", "]"}], "+", "1"}]}], ";", "\n", "\t", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"1", ",", "v_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "7", ",", "3", ",", "6", ",", "2", ",", "5", ",", "1", ",", "4", ",",
           "0"}], "}"}], "[", 
        RowBox[{"[", "v", "]"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"2", ",", "v_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "3", ",", "7", ",", "2", ",", "6", ",", "1", ",", "5", ",", "0", ",",
           "4"}], "}"}], "[", 
        RowBox[{"[", "v", "]"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"3", ",", "v_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "0", ",", "1", ",", "3", ",", "2", ",", "5", ",", "4", ",", "6", ",",
           "7"}], "}"}], "[", 
        RowBox[{"[", "v", "]"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"u_", ",", "v_"}], "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{"u", ",", "2"}], "]"}], "===", "0"}], ",", 
         RowBox[{"v", "-", "1"}], ",", 
         RowBox[{"8", "-", "v"}]}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"uptab", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "/", "2"}], ")"}], "^", "3"}], 
          RowBox[{"d", "[", 
           RowBox[{"u", ",", "v"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
      "\t", 
      RowBox[{"downtab", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "/", "2"}], ")"}], "^", "2"}], 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"i", "-", "j", "+", "k", "-", "1"}], ",", 
             RowBox[{"n", "/", "2"}]}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "/", "2"}], ")"}], 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"i", "-", "j", "-", "k"}], ",", 
             RowBox[{"n", "/", "2"}]}], "]"}]}], "+", 
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"i", "+", "j", "+", "k", "-", "2"}], ",", 
            RowBox[{"n", "/", "2"}]}], "]"}], "+", "1"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
      "\t", 
      RowBox[{"uptab", "+", "downtab"}]}]}], "\n", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Magic3D", "[", "x_", "]"}], ":=", 
   RowBox[{"Message", "[", 
    RowBox[{"Magic", "::", "nodef"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Magic3DShow", "[", "n_", "]"}], ":=", 
   RowBox[{"{", "\n", "\t", 
    RowBox[{
     RowBox[{"Graph3D", "@", 
      RowBox[{"GridGraph", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"n", ",", "n", ",", "n"}], "}"}], ",", 
        RowBox[{"VertexLabels", "->", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"i", "->", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"Magic3D", "@", "n"}], "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"n", "^", "3"}]}], "}"}]}], "]"}]}]}], "]"}]}], ",", 
     "\n", "\t", 
     RowBox[{"MatrixForm", "/@", 
      RowBox[{"Magic3D", "[", "n", "]"}]}]}], "\n", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Magic", "[", 
    RowBox[{"n_", ",", "\"\<3D\>\""}], "]"}], ":=", 
   RowBox[{"Magic3DShow", "@", 
    RowBox[{"Magic3D", "[", "n", "]"}]}]}], 
  ";"}]}], "Code",ExpressionUUID->"8b787378-c8f0-4c7e-beed-3486a91b96b9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:5e7b\:65b9\:5224\:522b\:8fc7\:7a0b", \
"Subsubsection",ExpressionUUID->"4c1a9bad-4646-494d-8670-fb61eed6b721"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MagicQ", "[", 
    RowBox[{"input_", ",", "\"\<3D\>\""}], "]"}], ":=", 
   RowBox[{"Magic3DQ", "[", "input", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MagicQ", "[", "matrix_", "]"}], ":=", "\n", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"SRow", ",", "SCol"}], "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"Echo", "[", 
       RowBox[{
       "\"\<\:8be5\:77e9\:9635\:6240\:6709\:6570\:5b57\:603b\:548c\:4e3a\>\"",
         "<>", 
        RowBox[{"ToString", "@", 
         RowBox[{"Total", "[", 
          RowBox[{"Total", "/@", "matrix"}], "]"}]}]}], "]"}], ";", "\n", 
      "\t", 
      RowBox[{"SRow", "=", 
       RowBox[{"Total", "/@", "matrix"}]}], ";", "\n", "\t", 
      RowBox[{"Echo", "[", 
       RowBox[{
       "\"\<\:8be5\:77e9\:9635\:5404\:884c\:548c\:5206\:522b\:4e3a\>\"", "<>", 
        RowBox[{"ToString", "@", "SRow"}]}], "]"}], ";", "\n", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "@@", "SRow"}], ",", 
        RowBox[{"Echo", "[", "\"\<\:901a\:8fc7\>\"", "]"}], ",", 
        RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", "\n", "\t", 
      RowBox[{"SCol", "=", 
       RowBox[{"Total", "/@", 
        RowBox[{"(", 
         RowBox[{"Transpose", "@", "matrix"}], ")"}]}]}], ";", "\n", "\t", 
      RowBox[{"Echo", "[", 
       RowBox[{
       "\"\<\:8be5\:77e9\:9635\:5404\:5217\:548c\:5206\:522b\:4e3a\>\"", "<>", 
        RowBox[{"ToString", "@", "SCol"}]}], "]"}], ";", "\n", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "@@", "SCol"}], ",", 
        RowBox[{"Echo", "[", "\"\<\:901a\:8fc7\>\"", "]"}], ",", 
        RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", "\n", "\t", 
      RowBox[{"Echo", "[", 
       RowBox[{
       "\"\<\:8be5\:77e9\:9635\:4e3b\:5bf9\:89d2\:7ebf\:548c\:4e3a\>\"", "<>", 
        RowBox[{"ToString", "@", 
         RowBox[{"Tr", "@", "matrix"}]}], "<>", 
        "\"\<,\:8be5\:77e9\:9635\:4e3b\:526f\:89d2\:7ebf\:548c\:4e3a\>\"", "<>",
         "\t", 
        RowBox[{"ToString", "@", 
         RowBox[{"Tr", "[", 
          RowBox[{"Reverse", "/@", "matrix"}], "]"}]}]}], "]"}], ";", "\n", 
      "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{
          RowBox[{"Tr", "@", "matrix"}], ",", 
          RowBox[{"Tr", "[", 
           RowBox[{"Reverse", "/@", "matrix"}], "]"}]}], "]"}], ",", "True", 
        ",", "False"}], "]"}]}]}], "\n", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Magic3DQ", "[", "x3d_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y3d", ",", "z3d", ",", "SF", ",", "LF", ",", "TF"}], "}"}], 
     ",", "\n", "\t", 
     RowBox[{
      RowBox[{"Echo", "[", 
       RowBox[{
       "\"\<\:8be5\:7acb\:65b9\:77e9\:9635\:6240\:6709\:6570\:5b57\:603b\:548c\
\:4e3a\>\"", "<>", 
        RowBox[{"ToString", "@", 
         RowBox[{"Total", "@", 
          RowBox[{"Flatten", "@", "x3d"}]}]}]}], "]"}], ";", "\n", "\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"y3d", ",", "z3d"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"x3d", ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"Transpose", "[", 
          RowBox[{"x3d", ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}]}], "}"}]}], ";",
       "\n", "\t", 
      RowBox[{"SF", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Total", "@", 
            RowBox[{"Flatten", "@", "#"}]}], "&"}], "/@", "x3d"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "@", 
            RowBox[{"Flatten", "@", "#"}]}], "&"}], "/@", "y3d"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "@", 
            RowBox[{"Flatten", "@", "#"}]}], "&"}], "/@", "z3d"}]}], "}"}]}], 
      ";", "\n", "\t", 
      RowBox[{"Echo", "[", 
       RowBox[{
       "\"\<\:8be5\:7acb\:65b9\:77e9\:9635\:5404\:9762\:548c\:5206\:522b\:4e3a\
\>\"", "<>", 
        RowBox[{"ToString", "@", "SF"}]}], "]"}], ";", "\n", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "@@", 
         RowBox[{"Flatten", "@", "SF"}]}], ",", 
        RowBox[{"Echo", "[", "\"\<\:901a\:8fc7\>\"", "]"}], ",", 
        RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", "\n", "\t", 
      RowBox[{"LF", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{"Total", ",", "x3d", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}], ",", 
         RowBox[{"Map", "[", 
          RowBox[{"Total", ",", "y3d", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}], ",", 
         RowBox[{"Map", "[", 
          RowBox[{"Total", ",", "z3d", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], "}"}]}], ";", "\n", "\t", 
      RowBox[{"Echo", "[", 
       RowBox[{
       "\"\<\:8be5\:7acb\:65b9\:77e9\:9635\:5404\:5217\:548c\:5206\:522b\:4e3a\
\>\"", "<>", 
        RowBox[{"ToString", "@", "LF"}]}], "]"}], ";", "\n", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "@@", 
         RowBox[{"Flatten", "@", "LF"}]}], ",", 
        RowBox[{"Echo", "[", "\"\<\:901a\:8fc7\>\"", "]"}], ",", 
        RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", "\n", "\t", 
      RowBox[{"TF", "=", 
       RowBox[{"Tr", "/@", 
        RowBox[{"{", 
         RowBox[{"x3d", ",", "y3d", ",", "z3d"}], "}"}]}]}], ";", "\n", "\t", 
      RowBox[{"Echo", "[", 
       RowBox[{
       "\"\<\:8be5\:7acb\:65b9\:77e9\:9635\:5404\:5bf9\:89d2\:7ebf\:548c\:5206\
\:522b\:4e3a\>\"", "<>", 
        RowBox[{"ToString", "@", "TF"}]}], "]"}], ";", "\n", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "@@", "TF"}], ",", "True", ",", "False"}], "]"}]}]}],
     "\n", "]"}]}], 
  ";"}]}], "Code",ExpressionUUID->"6b7711d4-a614-4bdb-a160-ee3912f71999"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\:9644\:52a0\:8bbe\:7f6e", \
"Subsection",ExpressionUUID->"edcd9bf4-239d-469d-ac49-0d6859d0d387"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"End", "[", "]"}], " ", ";"}], "\n", 
 RowBox[{
  RowBox[{"SetAttributes", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Magic", ",", "MagicQ"}], "}"}], ",", "\n", "\t", 
    RowBox[{"{", 
     RowBox[{"Protected", ",", "ReadProtected"}], "}"}]}], "\n", "]"}], 
  ";"}]}], "Code",
 CellChangeTimes->{
  3.7230938610262423`*^9},ExpressionUUID->"fc8c3609-77de-4a7b-befa-\
88ad055fc94d"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell["", "SectionSeparator",ExpressionUUID->"29327b60-a990-475f-8dca-\
bfc04c864cdb"]
},
WindowSize->{775, 873},
WindowMargins->{{564, Automatic}, {Automatic, 54}},
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (2017\:5e7410\:67082\
\:65e5)",
StyleDefinitions->FrontEnd`FileName[{"BTools"}, "CodePackage.nb", 
  CharacterEncoding -> "UTF-8"]
]

